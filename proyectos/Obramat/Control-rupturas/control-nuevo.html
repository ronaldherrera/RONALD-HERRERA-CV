<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />

    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
    <script id="lottie-data" type="application/json">
      {
        "nm": "Main Scene",
        "ddd": 0,
        "h": 300,
        "w": 300,
        "meta": { "g": "@lottiefiles/creator 1.46.1" },
        "layers": [
          {
            "ty": 0,
            "nm": "Nested Scene 1",
            "sr": 1,
            "st": 0,
            "op": 100,
            "ip": 0,
            "hd": false,
            "ddd": 0,
            "bm": 0,
            "hasMask": false,
            "ao": 0,
            "ks": {
              "a": { "a": 0, "k": [74.94055938720703, 75.75687408447266] },
              "s": { "a": 0, "k": [65.2735, 65.2735] },
              "sk": { "a": 0, "k": 0 },
              "p": {
                "a": 1,
                "k": [
                  {
                    "o": { "x": 0.55, "y": 0.06 },
                    "i": { "x": 0.36, "y": 1 },
                    "s": [196.7587, 158.9364],
                    "t": 0
                  },
                  {
                    "o": { "x": 0.65, "y": 0 },
                    "i": { "x": 0.36, "y": 1 },
                    "s": [138.864, 129.9891],
                    "t": 29
                  },
                  {
                    "o": { "x": 0.65, "y": 0 },
                    "i": { "x": 0.36, "y": 1 },
                    "s": [196.7587, 158.9364],
                    "t": 62
                  },
                  { "s": [196.7587, 158.9364], "t": 96 }
                ]
              },
              "r": { "a": 0, "k": 0 },
              "sa": { "a": 0, "k": 0 },
              "o": { "a": 0, "k": 100 }
            },
            "w": 800,
            "h": 304,
            "refId": "precomp_Shape Layer - SVG_276d66ea-5a2c-4e8b-bb95-46b29e7e5e9b",
            "ind": 1
          },
          {
            "ty": 4,
            "nm": "Group 25",
            "sr": 1,
            "st": 0,
            "op": 100,
            "ip": 0,
            "hd": false,
            "ddd": 0,
            "bm": 0,
            "hasMask": false,
            "ao": 0,
            "ks": {
              "a": { "a": 0, "k": [122.99992388486862, 149.5221100449562] },
              "s": { "a": 0, "k": [68.9986, 68.9986] },
              "sk": { "a": 0, "k": 0 },
              "p": { "a": 0, "k": [126.587, 139.2648] },
              "r": { "a": 0, "k": 0 },
              "sa": { "a": 0, "k": 0 },
              "o": { "a": 0, "k": 100 }
            },
            "shapes": [
              {
                "ty": "gr",
                "bm": 0,
                "hd": false,
                "nm": "Group 1",
                "it": [
                  {
                    "ty": "sh",
                    "bm": 0,
                    "hd": false,
                    "nm": "Path 1",
                    "d": 1,
                    "ks": {
                      "a": 0,
                      "k": {
                        "c": true,
                        "i": [
                          [0, 0],
                          [0, 0],
                          [0, -8.305099999999996],
                          [0, 0],
                          [-8.278099999999995, 0],
                          [0, 0],
                          [0, 8.305000000000007],
                          [0, 0],
                          [8.27800000000002, 0]
                        ],
                        "o": [
                          [0, 0],
                          [-8.278099999999995, 0],
                          [0, 0],
                          [0, 8.305000000000007],
                          [0, 0],
                          [8.27800000000002, 0],
                          [0, 0],
                          [0, -8.304500000000004],
                          [0, 0]
                        ],
                        "v": [
                          [189.439, 72.9102],
                          [87.2255, 72.9102],
                          [72.213, 87.9717],
                          [72.213, 144.373],
                          [87.2255, 159.434],
                          [189.439, 159.434],
                          [204.451, 144.373],
                          [204.451, 87.9717],
                          [189.439, 72.9102]
                        ]
                      }
                    }
                  },
                  {
                    "ty": "sh",
                    "bm": 0,
                    "hd": false,
                    "nm": "Path 2",
                    "d": 1,
                    "ks": {
                      "a": 0,
                      "k": {
                        "c": true,
                        "i": [
                          [0, 0],
                          [0, 0],
                          [0, 0],
                          [0, 0],
                          [0, 0]
                        ],
                        "o": [
                          [0, 0],
                          [0, 0],
                          [0, 0],
                          [0, 0],
                          [0, 0]
                        ],
                        "v": [
                          [122.681, 124.184],
                          [122.681, 108.161],
                          [153.984, 108.161],
                          [153.984, 124.184],
                          [122.681, 124.184]
                        ]
                      }
                    }
                  },
                  {
                    "ty": "sh",
                    "bm": 0,
                    "hd": false,
                    "nm": "Path 3",
                    "d": 1,
                    "ks": {
                      "a": 0,
                      "k": {
                        "c": true,
                        "i": [
                          [0, 0],
                          [0, 0],
                          [0, 0],
                          [0, 0],
                          [0, 0]
                        ],
                        "o": [
                          [0, 0],
                          [0, 0],
                          [0, 0],
                          [0, 0],
                          [0, 0]
                        ],
                        "v": [
                          [153.983, 133.797],
                          [153.983, 149.82],
                          [122.68, 149.82],
                          [122.68, 133.797],
                          [153.983, 133.797]
                        ]
                      }
                    }
                  },
                  {
                    "ty": "sh",
                    "bm": 0,
                    "hd": false,
                    "nm": "Path 4",
                    "d": 1,
                    "ks": {
                      "a": 0,
                      "k": {
                        "c": true,
                        "i": [
                          [0, 0],
                          [0, 0],
                          [0, 0],
                          [0, 0],
                          [0, 0]
                        ],
                        "o": [
                          [0, 0],
                          [0, 0],
                          [0, 0],
                          [0, 0],
                          [0, 0]
                        ],
                        "v": [
                          [81.7952, 108.161],
                          [113.098, 108.161],
                          [113.098, 124.183],
                          [81.7952, 124.183],
                          [81.7952, 108.161]
                        ]
                      }
                    }
                  },
                  {
                    "ty": "sh",
                    "bm": 0,
                    "hd": false,
                    "nm": "Path 5",
                    "d": 1,
                    "ks": {
                      "a": 0,
                      "k": {
                        "c": true,
                        "i": [
                          [0, 0],
                          [0, 0],
                          [0, 0],
                          [0, 0],
                          [0, 0]
                        ],
                        "o": [
                          [0, 0],
                          [0, 0],
                          [0, 0],
                          [0, 0],
                          [0, 0]
                        ],
                        "v": [
                          [122.681, 98.5471],
                          [122.681, 82.5243],
                          [153.984, 82.5243],
                          [153.984, 98.5471],
                          [122.681, 98.5471]
                        ]
                      }
                    }
                  },
                  {
                    "ty": "sh",
                    "bm": 0,
                    "hd": false,
                    "nm": "Path 6",
                    "d": 1,
                    "ks": {
                      "a": 0,
                      "k": {
                        "c": true,
                        "i": [
                          [0, 0],
                          [0, 0],
                          [0, 0],
                          [0, 0],
                          [0, 0]
                        ],
                        "o": [
                          [0, 0],
                          [0, 0],
                          [0, 0],
                          [0, 0],
                          [0, 0]
                        ],
                        "v": [
                          [163.566, 108.161],
                          [194.869, 108.161],
                          [194.869, 124.183],
                          [163.566, 124.183],
                          [163.566, 108.161]
                        ]
                      }
                    }
                  },
                  {
                    "ty": "sh",
                    "bm": 0,
                    "hd": false,
                    "nm": "Path 7",
                    "d": 1,
                    "ks": {
                      "a": 0,
                      "k": {
                        "c": true,
                        "i": [
                          [0, 0],
                          [0, 0],
                          [0, 0],
                          [0, 0],
                          [0, 0],
                          [0, -3.004000000000005]
                        ],
                        "o": [
                          [0, 0],
                          [0, 0],
                          [0, 0],
                          [0, 0],
                          [2.9939999999999998, 0],
                          [0, 0]
                        ],
                        "v": [
                          [194.869, 87.9717],
                          [194.869, 98.5471],
                          [163.566, 98.5471],
                          [163.566, 82.5243],
                          [189.439, 82.5243],
                          [194.869, 87.9717]
                        ]
                      }
                    }
                  },
                  {
                    "ty": "sh",
                    "bm": 0,
                    "hd": false,
                    "nm": "Path 8",
                    "d": 1,
                    "ks": {
                      "a": 0,
                      "k": {
                        "c": true,
                        "i": [
                          [0, 0],
                          [0, 0],
                          [0, 0],
                          [0, 0],
                          [0, 0],
                          [-2.994199999999992, 0]
                        ],
                        "o": [
                          [0, 0],
                          [0, 0],
                          [0, 0],
                          [0, 0],
                          [0, -3.004000000000005],
                          [0, 0]
                        ],
                        "v": [
                          [87.2255, 82.5243],
                          [113.098, 82.5243],
                          [113.098, 98.5471],
                          [81.7952, 98.5471],
                          [81.7952, 87.9717],
                          [87.2255, 82.5243]
                        ]
                      }
                    }
                  },
                  {
                    "ty": "sh",
                    "bm": 0,
                    "hd": false,
                    "nm": "Path 9",
                    "d": 1,
                    "ks": {
                      "a": 0,
                      "k": {
                        "c": true,
                        "i": [
                          [0, 0],
                          [0, 0],
                          [0, 0],
                          [0, 0],
                          [0, 0],
                          [0, 3.004000000000019]
                        ],
                        "o": [
                          [0, 0],
                          [0, 0],
                          [0, 0],
                          [0, 0],
                          [-2.994199999999992, 0],
                          [0, 0]
                        ],
                        "v": [
                          [81.7952, 144.373],
                          [81.7952, 133.797],
                          [113.098, 133.797],
                          [113.098, 149.82],
                          [87.2255, 149.82],
                          [81.7952, 144.373]
                        ]
                      }
                    }
                  },
                  {
                    "ty": "sh",
                    "bm": 0,
                    "hd": false,
                    "nm": "Path 10",
                    "d": 1,
                    "ks": {
                      "a": 0,
                      "k": {
                        "c": true,
                        "i": [
                          [0, 0],
                          [0, 0],
                          [0, 0],
                          [0, 0],
                          [0, 0],
                          [2.9939999999999998, 0]
                        ],
                        "o": [
                          [0, 0],
                          [0, 0],
                          [0, 0],
                          [0, 0],
                          [0, 3.004000000000019],
                          [0, 0]
                        ],
                        "v": [
                          [189.439, 149.82],
                          [163.566, 149.82],
                          [163.566, 133.797],
                          [194.869, 133.797],
                          [194.869, 144.373],
                          [189.439, 149.82]
                        ]
                      }
                    }
                  },
                  {
                    "ty": "fl",
                    "bm": 0,
                    "hd": false,
                    "nm": "Fill",
                    "c": { "a": 0, "k": [0.1373, 0.1216, 0.1255] },
                    "r": 1,
                    "o": { "a": 0, "k": 100 }
                  },
                  {
                    "ty": "tr",
                    "a": { "a": 0, "k": [0, 0] },
                    "s": { "a": 0, "k": [100, 100] },
                    "sk": { "a": 0, "k": 0 },
                    "p": { "a": 0, "k": [0, 0] },
                    "r": { "a": 0, "k": 0 },
                    "sa": { "a": 0, "k": 0 },
                    "o": { "a": 0, "k": 100 }
                  }
                ]
              },
              {
                "ty": "gr",
                "bm": 0,
                "hd": false,
                "nm": "Group 2",
                "it": [
                  {
                    "ty": "sh",
                    "bm": 0,
                    "hd": false,
                    "nm": "Path 11",
                    "d": 1,
                    "ks": {
                      "a": 0,
                      "k": {
                        "c": true,
                        "i": [
                          [0, 0],
                          [-0.4350000000000023, -1.0690000000000168],
                          [4.368000000000009, 0],
                          [0.5169999999999959, 0.7199999999999989],
                          [2.385000000000005, -1.1120000000000232],
                          [-1.1149999999999949, -2.4070000000000107],
                          [-6.699000000000012, 0],
                          [0, 6.5779999999999745],
                          [6.533000000000001, 1.6389999999999816],
                          [0.4350000000000023, 1.0689999999999884],
                          [-4.368000000000009, 0],
                          [-0.5169999999999959, -0.7199999999999989],
                          [-2.383999999999986, 1.1119999999999948],
                          [1.115000000000009, 2.4070000000000107],
                          [6.697999999999993, 0],
                          [0, -6.576999999999998],
                          [-6.5319999999999965, -1.63900000000001]
                        ],
                        "o": [
                          [5.604000000000013, 1.406000000000006],
                          [-0.7479999999999905, 0.7709999999999866],
                          [-4.834000000000003, 0],
                          [-1.1300000000000097, -2.3740000000000236],
                          [-2.399000000000001, 1.1189999999999998],
                          [2.530000000000001, 5.462999999999994],
                          [10.015999999999991, 0],
                          [0, -9.201000000000022],
                          [-5.603999999999999, -1.406000000000006],
                          [0.7480000000000047, -0.771000000000015],
                          [4.834000000000003, 0],
                          [1.1300000000000239, 2.3739999999999952],
                          [2.4000000000000057, -1.1189999999999998],
                          [-2.531000000000006, -5.462999999999994],
                          [-10.015999999999991, 0],
                          [0, 9.200999999999993],
                          [0, 0]
                        ],
                        "v": [
                          [124.393, 231.073],
                          [133.486, 234.8],
                          [125.556, 236.985],
                          [117.102, 234.592],
                          [110.759, 232.306],
                          [108.434, 238.691],
                          [125.555, 246.599],
                          [143.123, 235.062],
                          [126.717, 221.747],
                          [117.624, 218.02],
                          [125.555, 215.835],
                          [134.009, 218.228],
                          [140.351, 220.514],
                          [142.677, 214.129],
                          [125.556, 206.221],
                          [107.987, 217.758],
                          [124.393, 231.073]
                        ]
                      }
                    }
                  },
                  {
                    "ty": "fl",
                    "bm": 0,
                    "hd": false,
                    "nm": "Fill",
                    "c": { "a": 0, "k": [0.1373, 0.1216, 0.1255] },
                    "r": 1,
                    "o": { "a": 0, "k": 100 }
                  },
                  {
                    "ty": "tr",
                    "a": { "a": 0, "k": [0, 0] },
                    "s": { "a": 0, "k": [100, 100] },
                    "sk": { "a": 0, "k": 0 },
                    "p": { "a": 0, "k": [0, 0] },
                    "r": { "a": 0, "k": 0 },
                    "sa": { "a": 0, "k": 0 },
                    "o": { "a": 0, "k": 100 }
                  }
                ]
              },
              {
                "ty": "gr",
                "bm": 0,
                "hd": false,
                "nm": "Group 3",
                "it": [
                  {
                    "ty": "sh",
                    "bm": 0,
                    "hd": false,
                    "nm": "Path 12",
                    "d": 1,
                    "ks": {
                      "a": 0,
                      "k": {
                        "c": true,
                        "i": [
                          [0, 0],
                          [0, 0],
                          [0, 2.655000000000001],
                          [2.646799999999999, 0],
                          [0, 0],
                          [0, 0],
                          [2.6464, 0],
                          [0, -2.655000000000001],
                          [0, 0],
                          [-2.6464, 0]
                        ],
                        "o": [
                          [0, 0],
                          [2.6458000000000084, 0],
                          [0, -2.655000000000001],
                          [0, 0],
                          [0, 0],
                          [0, -2.655000000000001],
                          [-2.6464, 0],
                          [0, 0],
                          [0, 2.655000000000001],
                          [0, 0]
                        ],
                        "v": [
                          [71.8938, 246.599],
                          [97.4472, 246.599],
                          [102.239, 241.792],
                          [97.4472, 236.985],
                          [76.6852, 236.985],
                          [76.6852, 211.028],
                          [71.8938, 206.221],
                          [67.1024, 211.028],
                          [67.1024, 241.792],
                          [71.8938, 246.599]
                        ]
                      }
                    }
                  },
                  {
                    "ty": "fl",
                    "bm": 0,
                    "hd": false,
                    "nm": "Fill",
                    "c": { "a": 0, "k": [0.1373, 0.1216, 0.1255] },
                    "r": 1,
                    "o": { "a": 0, "k": 100 }
                  },
                  {
                    "ty": "tr",
                    "a": { "a": 0, "k": [0, 0] },
                    "s": { "a": 0, "k": [100, 100] },
                    "sk": { "a": 0, "k": 0 },
                    "p": { "a": 0, "k": [0, 0] },
                    "r": { "a": 0, "k": 0 },
                    "sa": { "a": 0, "k": 0 },
                    "o": { "a": 0, "k": 100 }
                  }
                ]
              },
              {
                "ty": "gr",
                "bm": 0,
                "hd": false,
                "nm": "Group 4",
                "it": [
                  {
                    "ty": "sh",
                    "bm": 0,
                    "hd": false,
                    "nm": "Path 13",
                    "d": 1,
                    "ks": {
                      "a": 0,
                      "k": {
                        "c": true,
                        "i": [
                          [0, 0],
                          [0, 0],
                          [-1.2257999999999996, 0],
                          [-0.9346999999999994, 0.938999999999993],
                          [1.871300000000005, 1.8770000000000095],
                          [0, 0],
                          [0, 0],
                          [1.871300000000005, 1.8770000000000095],
                          [1.870599999999996, -1.8769999999999811],
                          [0, 0],
                          [0, 0],
                          [1.8706999999999994, -1.8769999999999811],
                          [-1.8711999999999982, -1.8769999999999811],
                          [0, 0],
                          [0, 0],
                          [-1.8711999999999982, -1.8770000000000095],
                          [-1.2257999999999996, 0],
                          [-0.9353000000000016, 0.938999999999993],
                          [0, 0]
                        ],
                        "o": [
                          [0, 0],
                          [0.935299999999998, 0.9379999999999882],
                          [1.2257999999999996, 0],
                          [1.871300000000005, -1.8770000000000095],
                          [0, 0],
                          [0, 0],
                          [1.871300000000005, -1.8769999999999811],
                          [-1.871299999999998, -1.8769999999999811],
                          [0, 0],
                          [0, 0],
                          [-1.8711999999999982, -1.8769999999999811],
                          [-1.8711999999999982, 1.8770000000000095],
                          [0, 0],
                          [0, 0],
                          [-1.8711999999999982, 1.877999999999986],
                          [0.9354000000000013, 0.938999999999993],
                          [1.225800000000003, 0],
                          [0, 0],
                          [0, 0]
                        ],
                        "v": [
                          [36.1187, 233.208],
                          [48.0629, 245.191],
                          [51.4504, 246.599],
                          [54.8379, 245.191],
                          [54.8379, 238.393],
                          [42.8937, 226.41],
                          [54.8379, 214.427],
                          [54.8379, 207.629],
                          [48.0623, 207.629],
                          [36.1181, 219.612],
                          [24.1739, 207.629],
                          [17.3983, 207.629],
                          [17.3983, 214.427],
                          [29.3425, 226.41],
                          [17.3983, 238.393],
                          [17.3983, 245.191],
                          [20.7858, 246.599],
                          [24.1733, 245.191],
                          [36.1187, 233.208]
                        ]
                      }
                    }
                  },
                  {
                    "ty": "fl",
                    "bm": 0,
                    "hd": false,
                    "nm": "Fill",
                    "c": { "a": 0, "k": [0.1373, 0.1216, 0.1255] },
                    "r": 1,
                    "o": { "a": 0, "k": 100 }
                  },
                  {
                    "ty": "tr",
                    "a": { "a": 0, "k": [0, 0] },
                    "s": { "a": 0, "k": [100, 100] },
                    "sk": { "a": 0, "k": 0 },
                    "p": { "a": 0, "k": [0, 0] },
                    "r": { "a": 0, "k": 0 },
                    "sa": { "a": 0, "k": 0 },
                    "o": { "a": 0, "k": 100 }
                  }
                ]
              },
              {
                "ty": "gr",
                "bm": 0,
                "hd": false,
                "nm": "Group 5",
                "it": [
                  {
                    "ty": "sh",
                    "bm": 0,
                    "hd": false,
                    "nm": "Path 14",
                    "d": 1,
                    "ks": {
                      "a": 0,
                      "k": {
                        "c": true,
                        "i": [
                          [0, 0],
                          [0, 0],
                          [0, 5.664000000000016],
                          [0, 0],
                          [-5.645490000000001, 0],
                          [0, 0],
                          [0, -5.663999999999987],
                          [0, 0],
                          [5.646000000000015, 0]
                        ],
                        "o": [
                          [0, 0],
                          [-5.645490000000001, 0],
                          [0, 0],
                          [0, -5.663999999999987],
                          [0, 0],
                          [5.646000000000015, 0],
                          [0, 0],
                          [0, 5.664000000000016],
                          [0, 0]
                        ],
                        "v": [
                          [148.553, 262.302],
                          [10.566, 262.302],
                          [0.344849, 252.047],
                          [0.344849, 200.773],
                          [10.566, 190.519],
                          [148.553, 190.519],
                          [158.775, 200.773],
                          [158.775, 252.047],
                          [148.553, 262.302]
                        ]
                      }
                    }
                  },
                  {
                    "ty": "fl",
                    "bm": 0,
                    "hd": false,
                    "nm": "Fill",
                    "c": { "a": 0, "k": [0.6078, 0.9608, 0.4902] },
                    "r": 1,
                    "o": { "a": 0, "k": 100 }
                  },
                  {
                    "ty": "tr",
                    "a": { "a": 0, "k": [0, 0] },
                    "s": { "a": 0, "k": [100, 100] },
                    "sk": { "a": 0, "k": 0 },
                    "p": { "a": 0, "k": [0, 0] },
                    "r": { "a": 0, "k": 0 },
                    "sa": { "a": 0, "k": 0 },
                    "o": { "a": 0, "k": 100 }
                  }
                ]
              },
              {
                "ty": "gr",
                "bm": 0,
                "hd": false,
                "nm": "Group 6",
                "it": [
                  {
                    "ty": "sh",
                    "bm": 0,
                    "hd": false,
                    "nm": "Path 15",
                    "d": 1,
                    "ks": {
                      "a": 0,
                      "k": {
                        "c": true,
                        "i": [
                          [0, 0],
                          [0, 0],
                          [-5.6440000000000055, 0],
                          [0, 0],
                          [0, 0]
                        ],
                        "o": [
                          [0, 0],
                          [0, 5.6633],
                          [0, 0],
                          [0, 0],
                          [0, 0]
                        ],
                        "v": [
                          [194.549, 0.807129],
                          [194.549, 41.8258],
                          [204.77, 52.0803],
                          [245.655, 52.0803],
                          [194.549, 0.807129]
                        ]
                      }
                    }
                  },
                  {
                    "ty": "fl",
                    "bm": 0,
                    "hd": false,
                    "nm": "Fill",
                    "c": { "a": 0, "k": [1, 0.3451, 0] },
                    "r": 1,
                    "o": { "a": 0, "k": 100 }
                  },
                  {
                    "ty": "tr",
                    "a": { "a": 0, "k": [0, 0] },
                    "s": { "a": 0, "k": [100, 100] },
                    "sk": { "a": 0, "k": 0 },
                    "p": { "a": 0, "k": [0, 0] },
                    "r": { "a": 0, "k": 0 },
                    "sa": { "a": 0, "k": 0 },
                    "o": { "a": 0, "k": 100 }
                  }
                ]
              },
              {
                "ty": "gr",
                "bm": 0,
                "hd": false,
                "nm": "Group 7",
                "it": [
                  {
                    "ty": "sh",
                    "bm": 0,
                    "hd": false,
                    "nm": "Path 16",
                    "d": 1,
                    "ks": {
                      "a": 0,
                      "k": {
                        "c": true,
                        "i": [
                          [0, 0],
                          [0, 0],
                          [0, 0],
                          [-5.645399999999995, 0],
                          [0, 0],
                          [0, -5.663899999999998],
                          [0, 0]
                        ],
                        "o": [
                          [0, 0],
                          [0, 0],
                          [0, -5.663899999999998],
                          [0, 0],
                          [5.646000000000015, 0],
                          [0, 0],
                          [0, 0]
                        ],
                        "v": [
                          [199.66, 103.354],
                          [77.0044, 103.354],
                          [77.0044, 87.9723],
                          [87.2255, 77.7178],
                          [189.438, 77.7178],
                          [199.66, 87.9723],
                          [199.66, 103.354]
                        ]
                      }
                    }
                  },
                  {
                    "ty": "fl",
                    "bm": 0,
                    "hd": false,
                    "nm": "Fill",
                    "c": { "a": 0, "k": [0.4902, 0.7843, 0.4314] },
                    "r": 1,
                    "o": { "a": 0, "k": 100 }
                  },
                  {
                    "ty": "tr",
                    "a": { "a": 0, "k": [0, 0] },
                    "s": { "a": 0, "k": [100, 100] },
                    "sk": { "a": 0, "k": 0 },
                    "p": { "a": 0, "k": [0, 0] },
                    "r": { "a": 0, "k": 0 },
                    "sa": { "a": 0, "k": 0 },
                    "o": { "a": 0, "k": 100 }
                  }
                ]
              },
              {
                "ty": "gr",
                "bm": 0,
                "hd": false,
                "nm": "Group 8",
                "it": [
                  {
                    "ty": "sh",
                    "bm": 0,
                    "hd": false,
                    "nm": "Path 17",
                    "d": 1,
                    "ks": {
                      "a": 0,
                      "k": {
                        "c": true,
                        "i": [
                          [0, 0],
                          [0, 0],
                          [0, 5.664000000000016],
                          [0, 0],
                          [-5.645399999999995, 0],
                          [0, 0],
                          [0, 0]
                        ],
                        "o": [
                          [0, 0],
                          [-5.645399999999995, 0],
                          [0, 0],
                          [0, -5.663899999999998],
                          [0, 0],
                          [0, 0],
                          [0, 0]
                        ],
                        "v": [
                          [117.889, 154.627],
                          [87.2255, 154.627],
                          [77.0044, 144.373],
                          [77.0044, 87.9717],
                          [87.2255, 77.7172],
                          [117.889, 77.7172],
                          [117.889, 154.627]
                        ]
                      }
                    }
                  },
                  {
                    "ty": "fl",
                    "bm": 0,
                    "hd": false,
                    "nm": "Fill",
                    "c": { "a": 0, "k": [0.6078, 0.9608, 0.4902] },
                    "r": 1,
                    "o": { "a": 0, "k": 100 }
                  },
                  {
                    "ty": "tr",
                    "a": { "a": 0, "k": [0, 0] },
                    "s": { "a": 0, "k": [100, 100] },
                    "sk": { "a": 0, "k": 0 },
                    "p": { "a": 0, "k": [0, 0] },
                    "r": { "a": 0, "k": 0 },
                    "sa": { "a": 0, "k": 0 },
                    "o": { "a": 0, "k": 100 }
                  }
                ]
              },
              {
                "ty": "gr",
                "bm": 0,
                "hd": false,
                "nm": "Group 9",
                "it": [
                  {
                    "ty": "sh",
                    "bm": 0,
                    "hd": false,
                    "nm": "Path 18",
                    "d": 1,
                    "ks": {
                      "a": 0,
                      "k": {
                        "c": true,
                        "i": [
                          [0, 0],
                          [0, 0],
                          [0, 5.664000000000016],
                          [0, 0],
                          [-5.645399999999995, 0],
                          [0, 0],
                          [0, -5.663899999999998],
                          [0, 0],
                          [5.646000000000015, 0]
                        ],
                        "o": [
                          [0, 0],
                          [-5.645399999999995, 0],
                          [0, 0],
                          [0, -5.663899999999998],
                          [0, 0],
                          [5.646000000000015, 0],
                          [0, 0],
                          [0, 5.664000000000016],
                          [0, 0]
                        ],
                        "v": [
                          [189.438, 154.627],
                          [87.2255, 154.627],
                          [77.0044, 144.373],
                          [77.0044, 87.9717],
                          [87.2255, 77.7172],
                          [189.438, 77.7172],
                          [199.66, 87.9717],
                          [199.66, 144.373],
                          [189.438, 154.627]
                        ]
                      }
                    }
                  },
                  {
                    "ty": "fl",
                    "bm": 0,
                    "hd": false,
                    "nm": "Fill",
                    "c": { "a": 0, "k": [0.6863, 0.7255, 0.8235] },
                    "r": 1,
                    "o": { "a": 0, "k": 100 }
                  },
                  {
                    "ty": "tr",
                    "a": { "a": 0, "k": [0, 0] },
                    "s": { "a": 0, "k": [100, 100] },
                    "sk": { "a": 0, "k": 0 },
                    "p": { "a": 0, "k": [0, 0] },
                    "r": { "a": 0, "k": 0 },
                    "sa": { "a": 0, "k": 0 },
                    "o": { "a": 0, "k": 100 }
                  }
                ]
              },
              {
                "ty": "gr",
                "bm": 0,
                "hd": false,
                "nm": "Group 10",
                "it": [
                  {
                    "ty": "sh",
                    "bm": 0,
                    "hd": false,
                    "nm": "Path 19",
                    "d": 1,
                    "ks": {
                      "a": 0,
                      "k": {
                        "c": true,
                        "i": [
                          [0, 0],
                          [-5.6455000000000055, 0],
                          [0, 0],
                          [0, 0],
                          [0, 0],
                          [5.64500000000001, 0],
                          [0, 0],
                          [0, 5.663999999999987],
                          [0, 0]
                        ],
                        "o": [
                          [0, -5.663860000000001],
                          [0, 0],
                          [0, 0],
                          [0, 0],
                          [0, 5.663999999999987],
                          [0, 0],
                          [-5.645499999999998, 0],
                          [0, 0],
                          [0, 0]
                        ],
                        "v": [
                          [31.0082, 11.0616],
                          [41.2293, 0.807129],
                          [194.548, 0.807129],
                          [245.655, 52.0803],
                          [245.655, 287.938],
                          [235.434, 298.193],
                          [41.2299, 298.193],
                          [31.0088, 287.938],
                          [31.0082, 11.0616]
                        ]
                      }
                    }
                  },
                  {
                    "ty": "fl",
                    "bm": 0,
                    "hd": false,
                    "nm": "Fill",
                    "c": { "a": 0, "k": [1, 0.7686, 0.651] },
                    "r": 1,
                    "o": { "a": 0, "k": 100 }
                  },
                  {
                    "ty": "tr",
                    "a": { "a": 0, "k": [0, 0] },
                    "s": { "a": 0, "k": [100, 100] },
                    "sk": { "a": 0, "k": 0 },
                    "p": { "a": 0, "k": [0, 0] },
                    "r": { "a": 0, "k": 0 },
                    "sa": { "a": 0, "k": 0 },
                    "o": { "a": 0, "k": 100 }
                  }
                ]
              }
            ],
            "ind": 2
          }
        ],
        "v": "5.7.0",
        "fr": 24,
        "op": 100,
        "ip": 0,
        "assets": [
          {
            "nm": "Nested Scene 1",
            "id": "precomp_Shape Layer - SVG_276d66ea-5a2c-4e8b-bb95-46b29e7e5e9b",
            "fr": 24,
            "layers": [
              {
                "ty": 4,
                "nm": "Shape Layer - SVG",
                "sr": 1,
                "st": 0,
                "op": 100,
                "ip": 0,
                "hd": false,
                "ddd": 0,
                "bm": 0,
                "hasMask": false,
                "ao": 0,
                "ks": {
                  "a": { "a": 0, "k": [0, 0] },
                  "s": { "a": 0, "k": [100, 100] },
                  "sk": { "a": 0, "k": 0 },
                  "p": { "a": 0, "k": [0, 0] },
                  "r": { "a": 0, "k": 0 },
                  "sa": { "a": 0, "k": 0 },
                  "o": { "a": 0, "k": 100 }
                },
                "shapes": [
                  {
                    "ty": "gr",
                    "bm": 0,
                    "hd": false,
                    "nm": "Group 1",
                    "it": [
                      {
                        "ty": "sh",
                        "bm": 0,
                        "hd": false,
                        "nm": "Path 1",
                        "d": 1,
                        "ks": {
                          "a": 0,
                          "k": {
                            "c": true,
                            "i": [
                              [0, 0],
                              [0, -24.0587],
                              [-24.058300000000003, 0],
                              [0, 24.0586],
                              [24.05899999999999, 0]
                            ],
                            "o": [
                              [-24.058300000000003, 0],
                              [0, 24.0586],
                              [24.058299999999996, 0],
                              [0, -24.0587],
                              [0, 0]
                            ],
                            "v": [
                              [54.9164, 11.2839],
                              [11.2847, 54.9157],
                              [54.9164, 98.5474],
                              [98.5479, 54.9157],
                              [54.9164, 11.2839]
                            ]
                          }
                        }
                      },
                      {
                        "ty": "sh",
                        "bm": 0,
                        "hd": false,
                        "nm": "Path 2",
                        "d": 1,
                        "ks": {
                          "a": 0,
                          "k": {
                            "c": true,
                            "i": [
                              [0, 0],
                              [0, 19.910700000000006],
                              [-19.910700000000006, 0],
                              [0, -19.9107],
                              [19.9107, 0]
                            ],
                            "o": [
                              [-19.910700000000006, 0],
                              [0, -19.9107],
                              [19.910400000000003, 0],
                              [0, 19.910700000000006],
                              [0, 0]
                            ],
                            "v": [
                              [54.9164, 91.0248],
                              [18.8073, 54.9157],
                              [54.9164, 18.8066],
                              [91.0255, 54.9157],
                              [54.9164, 91.0248]
                            ]
                          }
                        }
                      },
                      {
                        "ty": "fl",
                        "bm": 0,
                        "hd": false,
                        "nm": "Fill",
                        "c": { "a": 0, "k": [0.1373, 0.1216, 0.1255] },
                        "r": 1,
                        "o": { "a": 0, "k": 100 }
                      },
                      {
                        "ty": "tr",
                        "a": { "a": 0, "k": [0, 0] },
                        "s": { "a": 0, "k": [100, 100] },
                        "sk": { "a": 0, "k": 0 },
                        "p": { "a": 0, "k": [0, 0] },
                        "r": { "a": 0, "k": 0 },
                        "sa": { "a": 0, "k": 0 },
                        "o": { "a": 0, "k": 100 }
                      }
                    ]
                  },
                  {
                    "ty": "gr",
                    "bm": 0,
                    "hd": false,
                    "nm": "Group 2",
                    "it": [
                      {
                        "ty": "sh",
                        "bm": 0,
                        "hd": false,
                        "nm": "Path 3",
                        "d": 1,
                        "ks": {
                          "a": 0,
                          "k": {
                            "c": true,
                            "i": [
                              [0, 0],
                              [0, 2.076900000000002],
                              [-5.9556000000000004, 5.413799999999995],
                              [-1.396799999999999, -1.5371999999999986],
                              [1.5367999999999995, -1.3975000000000009],
                              [0, -5.910299999999999],
                              [2.0775000000000006, 0]
                            ],
                            "o": [
                              [-2.0772000000000013, 0],
                              [0, -8.025199999999998],
                              [1.5371999999999986, -1.396799999999999],
                              [1.3969000000000023, 1.5371999999999986],
                              [-4.390599999999999, 3.991099999999996],
                              [0.00030000000000285354, 2.076900000000002],
                              [0, 0]
                            ],
                            "v": [
                              [30.0985, 58.6771],
                              [26.3372, 54.9158],
                              [35.7085, 33.7691],
                              [41.0216, 34.0222],
                              [40.7686, 39.3357],
                              [33.8598, 54.9161],
                              [30.0985, 58.6771]
                            ]
                          }
                        }
                      },
                      {
                        "ty": "fl",
                        "bm": 0,
                        "hd": false,
                        "nm": "Fill",
                        "c": { "a": 0, "k": [0.1373, 0.1216, 0.1255] },
                        "r": 1,
                        "o": { "a": 0, "k": 100 }
                      },
                      {
                        "ty": "tr",
                        "a": { "a": 0, "k": [0, 0] },
                        "s": { "a": 0, "k": [100, 100] },
                        "sk": { "a": 0, "k": 0 },
                        "p": { "a": 0, "k": [0, 0] },
                        "r": { "a": 0, "k": 0 },
                        "sa": { "a": 0, "k": 0 },
                        "o": { "a": 0, "k": 100 }
                      }
                    ]
                  },
                  {
                    "ty": "gr",
                    "bm": 0,
                    "hd": false,
                    "nm": "Group 3",
                    "it": [
                      {
                        "ty": "sh",
                        "bm": 0,
                        "hd": false,
                        "nm": "Path 4",
                        "d": 1,
                        "ks": {
                          "a": 0,
                          "k": {
                            "c": true,
                            "i": [
                              [0, 0],
                              [0.7424999999999926, 0.8161000000000058],
                              [-1.5368999999999886, 1.3974999999999937],
                              [0, 5.910599999999995],
                              [-2.076899999999995, 0],
                              [0, -2.076900000000002],
                              [5.955400000000012, -5.413800000000009],
                              [0.9026999999999958, 0]
                            ],
                            "o": [
                              [-1.0230000000000103, 0],
                              [-1.397500000000008, -1.5371999999999986],
                              [4.390500000000003, -3.9908000000000072],
                              [0, -2.076900000000002],
                              [2.076999999999998, 0],
                              [0, 8.025799999999997],
                              [-0.7203999999999979, 0.6548999999999978],
                              [0, 0]
                            ],
                            "v": [
                              [71.5956, 77.0404],
                              [68.8109, 75.8094],
                              [69.064, 70.4959],
                              [75.9724, 54.9155],
                              [79.7337, 51.1542],
                              [83.4951, 54.9155],
                              [74.124, 76.0622],
                              [71.5956, 77.0404]
                            ]
                          }
                        }
                      },
                      {
                        "ty": "fl",
                        "bm": 0,
                        "hd": false,
                        "nm": "Fill",
                        "c": { "a": 0, "k": [0.1373, 0.1216, 0.1255] },
                        "r": 1,
                        "o": { "a": 0, "k": 100 }
                      },
                      {
                        "ty": "tr",
                        "a": { "a": 0, "k": [0, 0] },
                        "s": { "a": 0, "k": [100, 100] },
                        "sk": { "a": 0, "k": 0 },
                        "p": { "a": 0, "k": [0, 0] },
                        "r": { "a": 0, "k": 0 },
                        "sa": { "a": 0, "k": 0 },
                        "o": { "a": 0, "k": 100 }
                      }
                    ]
                  },
                  {
                    "ty": "gr",
                    "bm": 0,
                    "hd": false,
                    "nm": "Group 4",
                    "it": [
                      {
                        "ty": "sh",
                        "bm": 0,
                        "hd": false,
                        "nm": "Path 5",
                        "d": 1,
                        "ks": {
                          "a": 0,
                          "k": {
                            "c": true,
                            "i": [
                              [0, 0],
                              [0, 21.9848],
                              [-21.984199999999994, 0],
                              [0, -21.9848],
                              [21.9848, 0]
                            ],
                            "o": [
                              [-21.984499999999997, 0],
                              [0, -21.9848],
                              [21.9848, 0],
                              [0, 21.9848],
                              [0, 0]
                            ],
                            "v": [
                              [54.9158, 94.7855],
                              [15.0454, 54.9151],
                              [54.9158, 15.0447],
                              [94.7862, 54.9151],
                              [54.9158, 94.7855]
                            ]
                          }
                        }
                      },
                      {
                        "ty": "fl",
                        "bm": 0,
                        "hd": false,
                        "nm": "Fill",
                        "c": { "a": 0, "k": [0.9255, 0.9412, 0.9451] },
                        "r": 1,
                        "o": { "a": 0, "k": 40 }
                      },
                      {
                        "ty": "tr",
                        "a": { "a": 0, "k": [0, 0] },
                        "s": { "a": 0, "k": [100, 100] },
                        "sk": { "a": 0, "k": 0 },
                        "p": { "a": 0, "k": [0, 0] },
                        "r": { "a": 0, "k": 0 },
                        "sa": { "a": 0, "k": 0 },
                        "o": { "a": 0, "k": 100 }
                      }
                    ]
                  },
                  {
                    "ty": "gr",
                    "bm": 0,
                    "hd": false,
                    "nm": "Group 5",
                    "it": [
                      {
                        "ty": "sh",
                        "bm": 0,
                        "hd": false,
                        "nm": "Path 6",
                        "d": 1,
                        "ks": {
                          "a": 0,
                          "k": {
                            "c": true,
                            "i": [
                              [0, 0],
                              [0, -30.329199999999997],
                              [-30.329199999999997, 0],
                              [0, 30.329100000000004],
                              [30.329500000000003, 0]
                            ],
                            "o": [
                              [-30.329199999999997, 0],
                              [0, 30.329100000000004],
                              [30.329100000000004, 0],
                              [0, -30.329199999999997],
                              [0, 0]
                            ],
                            "v": [
                              [54.9158, 0],
                              [0, 54.9158],
                              [54.9158, 109.832],
                              [109.832, 54.9158],
                              [54.9158, 0]
                            ]
                          }
                        }
                      },
                      {
                        "ty": "sh",
                        "bm": 0,
                        "hd": false,
                        "nm": "Path 7",
                        "d": 1,
                        "ks": {
                          "a": 0,
                          "k": {
                            "c": true,
                            "i": [
                              [0, 0],
                              [0, 21.9848],
                              [-21.984199999999994, 0],
                              [0, -21.984899999999996],
                              [21.9848, 0]
                            ],
                            "o": [
                              [-21.984499999999997, 0],
                              [0, -21.984899999999996],
                              [21.9848, 0],
                              [0, 21.9848],
                              [0, 0]
                            ],
                            "v": [
                              [54.9158, 94.7862],
                              [15.0453, 54.9158],
                              [54.9158, 15.0453],
                              [94.7862, 54.9158],
                              [54.9158, 94.7862]
                            ]
                          }
                        }
                      },
                      {
                        "ty": "fl",
                        "bm": 0,
                        "hd": false,
                        "nm": "Fill",
                        "c": { "a": 0, "k": [0.2941, 0.2863, 0.2863] },
                        "r": 1,
                        "o": { "a": 0, "k": 100 }
                      },
                      {
                        "ty": "tr",
                        "a": { "a": 0, "k": [0, 0] },
                        "s": { "a": 0, "k": [100, 100] },
                        "sk": { "a": 0, "k": 0 },
                        "p": { "a": 0, "k": [0, 0] },
                        "r": { "a": 0, "k": 0 },
                        "sa": { "a": 0, "k": 0 },
                        "o": { "a": 0, "k": 100 }
                      }
                    ]
                  },
                  {
                    "ty": "gr",
                    "bm": 0,
                    "hd": false,
                    "nm": "Group 6",
                    "it": [
                      {
                        "ty": "sh",
                        "bm": 0,
                        "hd": false,
                        "nm": "Path 8",
                        "d": 1,
                        "ks": {
                          "a": 0,
                          "k": {
                            "c": true,
                            "i": [
                              [0, 0],
                              [0, 0],
                              [2.8299999999999983, 2.8303000000000083],
                              [0, 0],
                              [3.6795999999999935, -3.679700000000011],
                              [0, 0],
                              [-3.679699999999997, -3.6799999999999926],
                              [0, 0],
                              [-3.455200000000005, 1.5250000000000057],
                              [0, 0],
                              [-3.680000000000007, 3.6789999999999736],
                              [0, 0],
                              [3.6789999999999736, 3.680000000000007]
                            ],
                            "o": [
                              [0, 0],
                              [1.5239999999999867, -3.455200000000005],
                              [0, 0],
                              [-3.6795000000000044, -3.679700000000011],
                              [0, 0],
                              [-3.679699999999997, 3.680000000000007],
                              [0, 0],
                              [2.831000000000003, 2.831000000000003],
                              [0, 0],
                              [3.680000000000007, 3.6789999999999736],
                              [0, 0],
                              [3.6799999999999784, -3.680000000000007],
                              [0, 0]
                            ],
                            "v": [
                              [147.122, 133.155],
                              [110.296, 96.3293],
                              [108.339, 85.8611],
                              [102.134, 79.6564],
                              [88.808, 79.6564],
                              [78.0615, 90.4028],
                              [78.0615, 103.729],
                              [84.2662, 109.934],
                              [94.7363, 111.893],
                              [131.56, 148.717],
                              [144.886, 148.717],
                              [147.121, 146.481],
                              [147.122, 133.155]
                            ]
                          }
                        }
                      },
                      {
                        "ty": "fl",
                        "bm": 0,
                        "hd": false,
                        "nm": "Fill",
                        "c": { "a": 0, "k": [0.0706, 0.0353, 0.2863] },
                        "r": 1,
                        "o": { "a": 0, "k": 100 }
                      },
                      {
                        "ty": "tr",
                        "a": { "a": 0, "k": [0, 0] },
                        "s": { "a": 0, "k": [100, 100] },
                        "sk": { "a": 0, "k": 0 },
                        "p": { "a": 0, "k": [0, 0] },
                        "r": { "a": 0, "k": 0 },
                        "sa": { "a": 0, "k": 0 },
                        "o": { "a": 0, "k": 100 }
                      }
                    ]
                  }
                ],
                "ind": 1
              }
            ]
          }
        ]
      }
    </script>
    <script src="https://unpkg.com/lottie-web/build/player/lottie.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js"></script>

    <script id="manifest-data" type="application/json">
      {
        "name": "Control de Ruptura",
        "short_name": "Rupturas",
        "start_url": "./index.html",
        "display": "standalone",
        "background_color": "#ffffff",
        "theme_color": "#FF5800",
        "orientation": "portrait",
        "icons": [
          {
            "src": "https://ronaldherrera.es/proyectos/Obramat/Control-rupturas/recursos/icono-192.png",
            "sizes": "192x192",
            "type": "image/png"
          }
        ]
      }
    </script>

    <!-----------------------------------------------------------------------padding-bottom: calc(
          var(--footer-h) + env(safe-area-inset-bottom, 0px)
        );------>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap");
      @import url("https://fonts.googleapis.com/css2?family=Roboto+Condensed:ital,wght@0,100..700;1,100..700&display=swap");

      :root {
        --footer-h: 42px;
      }

      html,
      body {
        height: 100%;
        margin: 0;
      }

      body {
        display: flex;
        flex-direction: column;
        font-family: "Roboto Condensed";
        background: #ffffff;
        height: 100vh;
      }

      .app-main {
        flex: 1; /* CLAVE */
        max-width: 800px;
      }

      header {
        background-color: #120949;
        color: white;
        padding: 1rem;
        text-align: center;
      }

      #header-secundario span {
        font-size: 12px;
      }

      main {
        margin: auto;
        align-self: center;
        max-width: 800px;
        height: auto;
        padding: 5px;
        text-align: center;
        display: flex;
        flex-direction: column;
        justify-content: flex-start;
      }

      main h2 {
        color: #120949;
        font-family: "Roboto";
        font-weight: 800;
      }

      main p {
        color: #494809;
        font-family: "Roboto";
        font-weight: 400;
        text-align: start;
        align-self: center;
      }

      main .inicio {
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      .footer {
        height: 42px;
        background: rgba(223, 223, 223, 0.96);
        backdrop-filter: blur(6px);
        border-top: 1px solid rgba(255, 255, 255, 0.15);
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .footer-link {
        background: #120949;
        border: 0;
        color: #fff;
        font-family: "Roboto Condensed";
        font-size: 12px;
        padding: 8px 6px;
        cursor: pointer;
        border-radius: 8px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 6px;
        user-select: none;
      }

      /* Contenido del footer */
      .footer-inner {
        width: min(800px, 100%);
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 6px;
        padding: 0 10px;
      }

      .footer-link {
        background: transparent;
        border: 0;
        color: #120949;
        font-family: "Roboto";
        font-weight: 600;
        font-size: 12px;
        padding: 8px 6px;
        cursor: pointer;
        border-radius: 8px;
      }

      .footer-link:hover {
        color: #11094979;
      }

      .footer-link strong {
        color: #ff5800;
        font-weight: 800;
      }

      /* ===== Modales del footer ===== */
      .modal-mini {
        position: fixed;
        inset: 0;
        display: none;
        z-index: 10000; /* por encima del resto */
      }

      .modal-mini[aria-hidden="false"] {
        display: block;
      }

      .modal-mini .modal-capa {
        position: absolute;
        inset: 0;
        background: rgba(0, 0, 0, 0.45);
        backdrop-filter: blur(2px);
      }

      .modal-mini .modal-caja {
        position: relative;
        width: min(940px, 94vw);
        margin: 2vh auto;
        background: #fff;
        border-radius: 12px;
        box-shadow: 0 12px 40px rgba(0, 0, 0, 0.25);
        overflow: hidden;
        display: flex;
        flex-direction: column;
      }

      .modal-mini .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: #120949;
        color: #fff;
        padding: 10px 14px;
      }

      .modal-mini .modal-header h3 {
        margin: 0;
        font-family: "Roboto";
        font-weight: 800;
        font-size: 14px;
      }

      .modal-mini .modal-cerrar {
        background: transparent;
        border: 0;
        color: #ff5800;
        font-size: 22px;
        cursor: pointer;
        line-height: 1;
      }

      .modal-mini .modal-body {
        padding: 10px 0px;

        overflow: auto;
      }

      #modal-creditos .modal-body {
        max-height: min(90vh, 620px);
      }

      /* Ayuda: de momento marco para scroll horizontal (luego lo curramos) */

      .modal-body {
        overflow-x: hidden;
      }

      .ayuda-slider {
        width: 100%;
        overflow: hidden;
      }

      .ayuda-track {
        display: flex;
        width: 100%;
        transform: translateX(0);
        transition: transform 260ms ease;
        will-change: transform;
      }

      .ayuda-step {
        flex: 0 0 100%;
        width: 100%;
        max-width: 100%;
        box-sizing: border-box;
        padding: 16px;
      }

      .ayuda-slider {
        width: 100%;
      }

      .ayuda-track {
        display: flex;
        transition: transform 260ms ease;
        will-change: transform;
      }

      .ayuda-step {
        flex: 0 0 100%;
        padding: 12px;
      }

      .ayuda-step h4 {
        margin: 0 0 8px;
        color: #ff5800;
      }

      .ayuda-step ul {
        margin: 8px 0 0 18px;
      }

      .ayuda-nota {
        margin-top: 8px;
        font-size: 0.9em;
        color: #666;
      }

      .ayuda-nav {
        display: grid;
        grid-template-columns: 1fr auto 1fr;
        align-items: center;
        gap: 10px;
        padding: 10px 12px 0;
      }

      .ayuda-btn {
        border: none;
        background: #120949;
        padding: 8px 10px;
        border-radius: 5px;
        cursor: pointer;
        color: #fff;
      }

      .ayuda-btn:disabled {
        background: rgba(255, 88, 0, 0.35);
        cursor: default;
      }

      .ayuda-dots {
        display: flex;
        gap: 8px;
        justify-content: center;
        align-items: center;
      }

      .ayuda-dot {
        width: 9px;
        height: 9px;
        border-radius: 999px;
        border: 1px solid rgba(255, 88, 0, 0.35);
        background: transparent;
        cursor: pointer;
        padding: 0;
      }

      .ayuda-dot.is-active {
        background: #ff5800;
        border-color: #ff5800;
      }

      /* QR */
      .qr-wrap {
        display: flex;
        flex-direction: column;
        gap: 10px;
        align-items: center;
      }

      .qr-box {
        width: 220px;
        height: 220px;
        display: grid;
        place-items: center;
        border-radius: 12px;
        border: 2px solid #ff5800;
        background: #fff;
      }

      .qr-link {
        font-size: 12px;
        color: #120949;
        word-break: break-all;
        text-align: center;
      }

      .btn-mini {
        background: #ff5800;
        color: #120949;
        font-weight: 800;
        border: 0;
        border-radius: 10px;
        padding: 10px 12px;
        cursor: pointer;
      }

      #animacion-lupa {
        align-self: center;
      }

      input[type="text"] {
        padding: 1rem;
        font-size: 1rem;
        width: 80%;
        max-width: 400px;
        margin: 1rem 0;
        background: #fff7dd;
        border: 1px solid rgba(255, 88, 0, 0.35);
        border-radius: 5px;
        text-align: start;
      }

      input[type="text"]:focus {
        outline: none;
        border: 1px solid #ff5800;
      }

      input[type="file"] {
        display: none;
      }

      label.boton-subir {
        background: #ff5800;
        color: #120949;
        margin-top: 20px;
        padding: 10px;
        width: 80%;
        max-width: 400px;
        font-size: 1rem;
        border-radius: 5px;
        cursor: pointer;
        display: inline-block;
        margin-bottom: 2rem;
        box-shadow: 0 4px #ff5800;
        font-weight: 700;
      }

      /* Contenedor general del bloque */
      #info-final {
        display: none;
        font-family: "Roboto Condensed";
        max-width: 800px;
        padding: 10px;
        font-weight: 800;
        margin-top: 20px;
        padding-bottom: 0px;
      }

      .boton-volver {
        display: flex;
      }

      /* Cada lnea (nombre o seccin + botn) */
      .info-linea {
        margin-bottom: 10px;
        display: flex;
        flex-direction: row;
        align-items: center;
        gap: 5px;
      }

      /* Segunda fila se comporta horizontal */
      .fila-secundaria {
        flex-direction: row;
        align-items: center;
        gap: 1rem;
        margin-bottom: 20px;
      }

      /* Contenedor para seccin */
      .info-seccion {
        flex-grow: 1;
        display: flex;
        flex-direction: row;
        align-items: center;
        gap: 5px;
      }

      /* Estilo de inputs */
      .info-output {
        width: 100%;
        border: none;
        border-bottom: 1px solid #ff5800;
        border-right: 1px solid #ff5800;
        outline: none;
        background: none;
        font-weight: 400;
        padding: 2px 0;
        text-align: start;
        height: 15px;
        font-size: 15px;
      }

      #campo-seccion {
        width: 40px;
      }

      /* Botn naranja */
      .boton-reiniciar {
        background: #ff5800;
        color: #ffffff;
        font-weight: bold;
        border: none;
        height: 25px;
        border-radius: 5px;
        cursor: pointer;
        width: 100%;
        box-shadow: 1px 1px 4px rgba(0, 0, 0, 0.212);
      }

      .productos-titulo {
        font-weight: 700;
        margin-bottom: 2px;
        font-size: 20px;
      }

      .tarjeta {
        background: white;
        margin: 0px auto 20px;
        padding: 0;
        width: 95%;
        max-width: 800px;
        border-top: 2px solid #ff5800;
        border-radius: 0px 0px 10px 10px;
        box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.37);
        overflow: hidden;
        transition: all 0.3s ease;
      }
      .tarjeta-titulo {
        background-color: #dedddd;
        padding: 8px 8px 0px;
        text-align: start;
        font-size: 13px;
      }

      .tarjeta-titulo .nombre {
        border-bottom: 1px solid #8c8c8c6e;
      }

      .tarjeta-cabecera {
        background-color: #dedddd;
        padding: 8px 8px 12px;
        display: flex;
        justify-content: space-between;
        align-items: flex-end;
        cursor: pointer;
        font-size: 13px;
      }

      .cabecera-izquierda {
        text-align: start;
      }

      .toggle-icon {
        width: 10px;
        transition: transform 0.3s ease; /* animacin fluida */
        transform-origin: center;
      }

      .cabecera-izquierda .nombre {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-weight: bold;
      }

      .badge-avs {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        height: 14px;
        padding: 0 3px;
        text-shadow: 0px 0px 2px #000000;
        font-size: 8px;
        font-weight: 900;
        letter-spacing: 0.6px;
        text-transform: uppercase;

        color: #ffffff;
        border-radius: 3px;

        background: linear-gradient(90deg, #ffd60a, #ff5800, #ff9500, #ffd60a);

        background-size: 200% 100%;
        animation: avs-rainbow 2.2s ease-in-out infinite alternate;

        /* sombra paralela */
        filter: drop-shadow(1px 1px 1px #00000088);
        user-select: none;
      }

      .cabecera-izquierda .ean {
        font-size: 0.85rem;
        color: #555;
        font-style: italic;
        display: flex;
        flex-direction: column;
        gap: 5px;
      }

      .cabecera-izquierda .ean em {
        font-weight: bold;
        color: #666;
      }

      .switch-informe {
        position: relative;
        display: inline-block;
        width: 70px;
        height: 15px;
        vertical-align: middle;
      }

      .switch-informe input {
        position: absolute;
        opacity: 0;
        width: 0;
        height: 0;
      }

      .slider-text {
        position: absolute;
        inset: 0;
        border-radius: 50px;
        background-color: #478140; /* verde (Incluido) */
        color: #fff;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 12px;
        font-weight: 400;
        transition: background-color 0.2s ease;
        pointer-events: none;
        font-style: normal;
        box-shadow: inset 0px 0px 3px 0.15px #000000a6;
      }

      /* El TEXTO vive en ::after y cambia solo con :checked */
      .slider-text::after {
        content: "incluido";
      }

      .switch-informe input:not(:checked) + .slider-text {
        background-color: rgba(255, 88, 0, 0.35); /* rojo (Excluido) */
      }
      .switch-informe input:not(:checked) + .slider-text::after {
        content: "excluido";
      }

      /* Bolita con transicin suave */
      .slider-text::before {
        content: "";
        position: absolute;
        height: 11px;
        width: 11px;
        left: 2px;
        top: 2px;
        background: #fff;
        border-radius: 50%;
        box-shadow: 0px 0px 3px 0.15px #000000a6;
        transition: transform 0.3s ease;
        transform: translateX(55px); /* estado marcado: derecha */
      }
      .switch-informe input:not(:checked) + .slider-text::before {
        transform: translateX(0); /* no marcado: izquierda */
      }

      .cabecera-derecha {
        display: flex;
        flex-direction: column-reverse;
        align-items: flex-end;
        gap: 5px;
      }

      .cabecera-derecha span {
        font-weight: bold;
      }

      .cabecera-derecha .stock {
        border-bottom: 1px solid #ff5800;
        border-right: 1px solid #ff5800;
        display: inline-block;
        padding-bottom: 2px;
        padding-right: 5px;
      }

      .cabecera-derecha .referencia {
        font-size: 0.85rem;
        color: #777;
      }

      .tarjeta-detalle span {
        font-weight: 500;
        font-style: italic;
        font-size: 10px;
      }

      .tarjeta-detalle {
        max-height: 0;
        overflow: hidden;
        opacity: 0;
        transition: max-height 0.4s ease, opacity 0.4s ease;
        display: grid; /* se mantiene pero no se ver mientras est colapsada */
        grid-template-columns: repeat(3, 1fr);
        grid-template-rows: repeat(5, auto);
        gap: 10px;
        padding: 0px;
        background-color: #dedddd;
        text-align: start;
      }

      .tarjeta[data-abierta="true"] .tarjeta-detalle {
        padding: 8px 8px 12px;
        max-height: 1000px; /* lo suficientemente grande para cualquier tarjeta */
        opacity: 1;
      }

      .tarjeta-detalle > div {
        padding: 0.5rem;
        box-sizing: border-box;
        font-size: 12px;
      }

      .detalle-proveedor {
        grid-column: 1 / span 2;
        grid-row: 1;
        background: #ffffff;
        box-shadow: 0px 0px 5px 0px #00000046 inset;
        border-radius: 5px;
      }

      .detalle-ubicacion span {
        color: #9a9898;
        font-size: 10px;
      }

      .detalle-ubicacion {
        color: #ffffff;
        grid-column: 3;
        grid-row: 1 / span 2;
        background: #120949;
        box-shadow: 0px 0px 5px 0px #00000046 inset;
        border-radius: 5px;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
      }

      .detalle-ventas {
        grid-column: 1 / span 2;
        grid-row: 2;
        background: #ffffff;
        box-shadow: 0px 0px 5px 0px #00000046 inset;
        border-radius: 5px;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .detalle-ventas table {
        width: 100%;
        font-size: 10px;
        border-collapse: collapse;
        text-align: center;
      }

      .detalle-ventas th,
      .detalle-ventas td {
        border: none;
        padding: 2px;
      }

      .detalle-ventas td:not(:last-child),
      .detalle-ventas th:not(:last-child) {
        border-right: 2px solid #ff5800;
      }

      .detalle-ventas table tr:first-child th {
        border-bottom: 2px solid #120949;
      }

      .detalle-pedidos {
        grid-column: 1;
        grid-row: 3 / span 2;
        background: #ff5800;
        box-shadow: 0px 0px 5px 0px #00000046 inset;
        border-radius: 5px;
        color: #ffffff;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .detalle-proximo {
        grid-column: 2 / span 2;
        grid-row: 3 / span 2;
        background: #ff5800;
        box-shadow: 0px 0px 5px 0px #00000046 inset;
        border-radius: 5px;
        color: #ffffff;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .detalle-causa {
        grid-column: 1 / span 2;
        grid-row: 5;
      }

      .detalle-edita {
        grid-column: 3;
        grid-row: 5;
        background: #8c8c8c;
        box-shadow: 0px 0px 5px 0px #00000046 inset;
        border-radius: 5px;
        color: #ffffff;
      }

      .tarjeta-pie {
        border-top: 1px solid rgba(255, 88, 0, 0.35);
        padding: 8px;
        padding-top: 12px;
        background: #fff7dd;
        display: flex;
        flex-direction: column;
        gap: 5px;
      }

      .tarjeta-pie1 {
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
      }

      .comentario-input {
        flex: 1 1 100%;
        width: 100%;
        min-height: 28px;
        max-height: 120px;
        resize: none; /* controlamos altura con JS */
        border: 1px solid rgba(255, 88, 0, 0.35);
        border-radius: 5px;
        padding: 6px 8px;
        font-size: 16px;
        line-height: 1.2;
        background: #ffffff;
        color: #000;
        box-sizing: border-box;
        font-family: "Roboto";
      }

      .comentario-input:focus {
        outline: none;
        border-color: 1px solid #ff5800;
        box-shadow: 0 0 0 1px #ff5800 inset;
      }

      label {
        margin: 0px;
        height: 20px;
        display: flex;
        align-items: center;
        gap: 5px;
      }

      .grupo-stock label {
        display: flex;
        justify-content: center;
      }

      .tarjeta-pie label {
        font-size: 12px;
      }

      .grupo-radio,
      .grupo-stock {
        font-size: 10px;
      }

      input.stock-real {
        background: #ffffff;
        border: 1px solid rgba(255, 88, 0, 0.35);

        border-radius: 3px;
        width: 88%;
        height: 88%;
        color: black;
        font-size: 16px;
      }

      input.stock-real:focus {
        outline: none;
        border: 1px solid #ff5800;
      }

      /* Eliminar flechas de input[type=number] (Chrome, Safari, Edge) */
      input[type="number"]::-webkit-inner-spin-button,
      input[type="number"]::-webkit-outer-spin-button {
        -webkit-appearance: none;
        margin: 0;
      }

      .grupo-radio,
      .grupo-stock {
        display: inline-flex;
        flex-direction: column;
        align-items: center;
        height: 30px;
        width: 80px;
        border: 1px solid rgba(255, 88, 0, 0.35);
        border-radius: 5px;
      }

      .grupo-stock span {
        background-color: #000;
        margin-top: -5px;
        margin-left: -18px;
        padding: 0px 5px;
        background: #fff7dd;
      }

      .grupo-radio span {
        background-color: #000;
        margin-top: -5px;
        margin-left: -30px;
        padding: 0px 5px;
        background: #fff7dd;
      }

      .grupo-radio div,
      .grupo-stock div {
        display: flex;
        justify-content: space-around;
        width: 100%;
      }

      .grupo-radio label {
        display: flex;

        gap: 0px;
      }

      .grupo-radio input {
        margin: 1px;
      }

      .grupo-radio input[type="radio"] {
        accent-color: #ff5800;
        appearance: none;
        -webkit-appearance: none;
        width: 12px;
        height: 12px;
        border-radius: 50%;
        border: 1px solid rgba(255, 88, 0, 0.35); /*  BORDE CONTROLADO */
        background: #fff;
        cursor: pointer;
      }

      input[type="radio"]:checked {
        background: radial-gradient(#ff5800 60%, transparent 10%);
      }

      .btn-decision {
        height: 30px;
        font-weight: 400;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        color: white;
        width: 90px;
        font-size: 10px;
      }

      .estado-neutro {
        background-color: rgba(255, 88, 0, 0.35);
      }

      .estado-pedir {
        background-color: #ff5800;
      }

      .estado-nopedir {
        background-color: #120949;
      }

      #boton-descargar:disabled {
        background-color: #ccc;
        color: #666;
        cursor: not-allowed;
        box-shadow: none;
        opacity: 0.7;
        box-shadow: 0px 0px 5px 0px #00000046 inset;
      }

      #boton-descargar {
        background: #120949;
        color: #ffffff;
        font-weight: bold;
        border: none;
        height: 40px;
        border-radius: 5px;
        cursor: pointer;
        width: 80%;
        box-shadow: 1px 1px 4px rgba(0, 0, 0, 0.212);
        align-self: center;
        margin-top: 20px;
        margin-bottom: 50px;
      }

      @keyframes pulse {
        0% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.1);
        }
        100% {
          transform: scale(1);
        }
      }

      .btn-decision.animar {
        animation: pulse 0.3s ease;
      }

      /* ===== Modal visor ===== */
      .modal {
        position: fixed;
        inset: 0;
        display: none;
        z-index: 9999;
      }
      .modal[aria-hidden="false"] {
        display: block;
      }

      .modal-capa {
        position: absolute;
        inset: 0;
        background: rgba(0, 0, 0, 0.45);
        backdrop-filter: blur(2px);
      }

      .modal-caja {
        position: relative;
        max-width: 960px;
        width: 95%;
        margin: 4vh auto;
        background: #fff;
        border-radius: 10px;
        box-shadow: 0 12px 40px rgba(0, 0, 0, 0.25);
        display: flex;
        flex-direction: column;
        overflow: hidden;
      }

      .ayuda-media {
        display: flex;
        justify-content: center;
        margin-top: 12px;
        width: 100%;
        border-radius: 8px;
        overflow: hidden;
      }

      .ayuda-media img {
        display: block;
        width: 50%;
        height: auto;
      }

      .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: #120949;
        color: #fff;
        padding: 12px 16px;
      }
      .modal-header h3 {
        margin: 0;
        font-family: "Roboto";
        font-weight: 800;
      }

      .modal-cerrar {
        background: transparent;
        border: 0;
        color: #fff;
        font-size: 18px;
        cursor: pointer;
        line-height: 1;
      }

      .modal-campo {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 10px 16px;
      }
      .modal-campo label {
        font-weight: 700;
        color: #120949;
      }
      #nombre-archivo {
        flex: 1;
        padding: 8px 10px;
        border: 1px solid #ff5800;
        border-radius: 6px;
        font-size: 14px;
        font-family: "Roboto Condensed";
      }

      .modal-visor {
        height: min(70vh, 700px);
        border-top: 1px solid #eee;
        border-bottom: 1px solid #eee;
      }
      #visor-pdf {
        width: 100%;
        height: 100%;
        border: 0;
        display: block;
        background: #f6f6f6;
      }

      .modal-acciones {
        display: flex;
        gap: 10px;
        justify-content: flex-end;
        padding: 12px 16px;
      }

      /* ===== Crditos (modal) ===== */
      .creditos-grid {
        display: grid;
        grid-template-columns: 1.05fr 1.35fr;
        gap: 12px;
      }

      @media (max-width: 820px) {
        .creditos-grid {
          grid-template-columns: 1fr;
        }
      }

      .creditos-card {
        border: 1px solid #eee;
        border-radius: 12px;
        padding: 12px;
        background: #fff;
        margin: 10px;
      }

      .creditos-top {
        display: grid;
        grid-template-columns: 72px 1fr;
        gap: 12px;
        align-items: center;
      }

      .creditos-foto {
        width: 72px;
        height: 72px;
        border-radius: 14px;
        object-fit: cover;
        border: 2px solid #ff5800;
        background: #f5f5f5;
      }

      .creditos-identidad {
        display: grid;
        gap: 3px;
      }

      .creditos-nombre {
        font-weight: 900;
        font-size: 16px;
        color: #120949;
      }

      .creditos-rol {
        font-size: 13px;
        color: #333;
      }

      .creditos-depto {
        color: #ff5800;
        font-weight: 800;
      }

      .creditos-zona {
        font-size: 12px;
        color: #777;
      }

      .creditos-sep {
        border: none;
        border-top: 1px solid #eee;
        margin: 12px 0;
      }

      .creditos-contacto {
        display: grid;
        gap: 10px;
      }

      .contacto-item {
        display: grid;
        gap: 2px;
      }

      .contacto-label {
        font-size: 11px;
        color: #777;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.6px;
      }

      .contacto-value {
        font-size: 13px;
        color: #120949;
        text-decoration: none;
        font-weight: 800;
      }

      .contacto-value:hover {
        text-decoration: underline;
        color: #ff5800;
      }

      .creditos-texto .creditos-h {
        margin: 0 0 6px;
        font-size: 13px;
        font-weight: 900;
        color: #120949;
      }

      .creditos-texto .creditos-p {
        margin: 0 0 10px;
        font-size: 13px;
        line-height: 1.35;
        color: #333;
      }

      .creditos-muted {
        color: #666;
      }

      .creditos-cta {
        display: flex;
        justify-content: flex-end;
        margin-top: 6px;
      }

      .btn {
        border: 0;
        border-radius: 6px;
        cursor: pointer;
        padding: 10px 14px;
        font-weight: 700;
        box-shadow: 0 1px 4px rgba(0, 0, 0, 0.15);
      }
      .btn.primario {
        background: #120949;
        color: #fff;
      }
      .btn.secundario {
        background: #ff5800;
        color: #120949;
      }
      .btn:disabled {
        opacity: 0.6;
        cursor: not-allowed;
      }

      html,
      body {
        touch-action: pan-y; /* permite scroll vertical, NO pinch-zoom */
        -ms-touch-action: pan-y;
      }

      input,
      select,
      textarea,
      button {
        font-size: 16px; /* iOS no hace zoom al enfocar si 16px */
      }

      * {
        -webkit-tap-highlight-color: rgba(
          0,
          0,
          0,
          0
        ); /* UX ms limpia en iOS */
        -webkit-user-select: none;
        user-select: none; /* si necesitas seleccin en textos, quita esto en esos bloques */
      }

      @keyframes avs-rainbow {
        0% {
          background-position: 0% 50%;
        }
        100% {
          background-position: 100% 50%;
        }
      }
    </style>
    <!----------------------------------------------------------------------------->
  </head>
  <body>
    <header id="header-principal">
      <img
        src="https://ronaldherrera.es/proyectos/Obramat/Control-rupturas/recursos/logo%20m.svg"
      />
    </header>

    <header id="header-secundario" style="display: none">
      <div
        style="
          display: flex;
          justify-content: space-between;
          align-items: center;
          background-color: #120949;

          color: white;
        "
      >
        <div>
          <strong>Control de rupturas</strong>
          <span
            id="fecha-header"
            style="color: #ff5800; font-weight: 400; margin-left: 8px"
          ></span>
        </div>
        <img
          src="https://ronaldherrera.es/proyectos/Obramat/Control-rupturas/recursos/logo%20m.svg"
          alt="logo"
          style="height: 30px"
        />
      </div>
    </header>

    <main class="app-main">
      <div id="seccion-inicial">
        <div class="inicio">
          <h2>Control de rupturas</h2>
          <div id="animacion-lupa" style="width: 100px; height: 100px"></div>
          <p id="info-usuario">
            <strong>1 </strong>Introduce tu nombre<br /><strong>2 </strong
            >Sube un archivo .xls
          </p>
        </div>

        <div class="inicio">
          <input type="text" id="nombre-usuario" placeholder="Quin eres?" />
          <br />
          <label for="archivo-excel" class="boton-subir">Sube tu archivo</label>
          <input type="file" id="archivo-excel" accept=".xls,.xlsx" />
        </div>
      </div>

      <div id="info-final" style="display: none">
        <div class="info-linea">
          <div id="boton-volver" class="boton-volver">
            <svg
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M15 18L9 12L15 6"
                stroke="#FF5800"
                stroke-width="3"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
          </div>

          <span>Colaborador/a:</span>
          <div id="campo-nombre" class="info-output"></div>
        </div>

        <div class="info-linea fila-secundaria">
          <div class="info-seccion">
            <span>Seccin:</span>
            <div id="campo-seccion" class="info-output"></div>
          </div>
          <button id="boton-reiniciar" class="boton-reiniciar">
            Volver a subir archivo
          </button>
        </div>
        <span class="productos-titulo">Productos</span>
      </div>

      <div id="contenedor-productos"></div>

      <button id="boton-descargar" style="display: none">
        Descargar Excel Modificado
      </button>
    </main>

    <!----------------------------------------------------------------------------->
    <script>
      function initAyudaSlider() {
        const root = document.querySelector('[data-slider="ayuda"]');
        if (!root || root.__inited) return;
        root.__inited = true;

        const track = root.querySelector("[data-track]");
        const steps = Array.from(root.querySelectorAll("[data-step]"));
        const dotsWrap = root.querySelector("[data-dots]");
        const btnPrev = root.querySelector("[data-prev]");
        const btnNext = root.querySelector("[data-next]");

        if (!track || !steps.length || !dotsWrap || !btnPrev || !btnNext)
          return;

        let index = 0;

        //  Importante para mvil: permite scroll vertical normal, pero gestionamos el horizontal nosotros
        root.style.touchAction = "pan-y";

        // ---- dots
        const dots = steps.map((_, i) => {
          const b = document.createElement("button");
          b.type = "button";
          b.className = "ayuda-dot";
          b.setAttribute("aria-label", `Ir al paso ${i + 1}`);
          b.addEventListener("click", () => goTo(i));
          dotsWrap.appendChild(b);
          return b;
        });

        function setTranslate(percent) {
          track.style.transform = `translateX(${percent}%)`;
        }

        function update() {
          // vuelve al modo animado normal
          track.style.transition = "transform .28s ease";
          setTranslate(-index * 100);
          dots.forEach((d, i) => d.classList.toggle("is-active", i === index));
          btnPrev.disabled = index === 0;
          btnNext.disabled = index === steps.length - 1;
        }

        function goTo(i) {
          index = Math.max(0, Math.min(steps.length - 1, i));
          update();
        }

        btnPrev.addEventListener("click", () => goTo(index - 1));
        btnNext.addEventListener("click", () => goTo(index + 1));

        update();

        // =========================
        //  Swipe / drag (mvil)
        // =========================
        let dragging = false;
        let startX = 0;
        let startY = 0;
        let dx = 0;
        let lock = null; // "x" o "y"
        let pointerId = null;

        const THRESHOLD_RATIO = 0.18; // 18% del ancho para cambiar de paso

        function onPointerDown(e) {
          // Solo gesto tctil (evita liarla con el ratn en PC)
          if (e.pointerType === "mouse") return;

          dragging = true;
          pointerId = e.pointerId;
          root.setPointerCapture(pointerId);

          startX = e.clientX;
          startY = e.clientY;
          dx = 0;
          lock = null;

          // sin transicin mientras arrastras
          track.style.transition = "none";
        }

        function onPointerMove(e) {
          if (!dragging || e.pointerId !== pointerId) return;

          dx = e.clientX - startX;
          const dy = e.clientY - startY;

          // Decide si es gesto horizontal o vertical
          if (lock === null) {
            if (Math.abs(dx) > 6 || Math.abs(dy) > 6) {
              lock = Math.abs(dx) > Math.abs(dy) ? "x" : "y";
            } else {
              return;
            }
          }

          // Si es vertical, dejamos que el modal haga scroll normal
          if (lock === "y") return;

          // Horizontal: evitamos el scroll del navegador y movemos el track a mano
          e.preventDefault();

          const w = Math.max(1, root.clientWidth);
          const deltaPercent = (dx / w) * 100;

          // base: -index*100, + delta del gesto
          setTranslate(-index * 100 + deltaPercent);
        }

        function endDrag(e) {
          if (!dragging || e.pointerId !== pointerId) return;

          dragging = false;

          if (lock !== "x") {
            // si fue vertical o no se decidi, restauramos
            update();
            return;
          }

          const w = Math.max(1, root.clientWidth);
          const ratio = Math.abs(dx) / w;

          if (ratio >= THRESHOLD_RATIO) {
            // swipe: dx<0 => siguiente, dx>0 => anterior
            goTo(dx < 0 ? index + 1 : index - 1);
          } else {
            // vuelve al paso actual
            update();
          }

          dx = 0;
          lock = null;
          pointerId = null;
        }

        root.addEventListener("pointerdown", onPointerDown, { passive: true });
        root.addEventListener("pointermove", onPointerMove, { passive: false });
        root.addEventListener("pointerup", endDrag, { passive: true });
        root.addEventListener("pointercancel", endDrag, { passive: true });
      }

      /*  Inicializa cuando el modal se abre */
      document.addEventListener("click", (e) => {
        const btn = e.target.closest('[data-open="modal-ayuda"]');
        if (!btn) return;

        // esperamos al siguiente tick por si el modal se muestra con JS
        setTimeout(initAyudaSlider, 0);
      });

      /*  Backup: tambin al cargar DOM */
      document.addEventListener("DOMContentLoaded", initAyudaSlider);

      // --- Animacin Lottie ---
      const lottieJson = JSON.parse(
        document.getElementById("lottie-data").textContent
      );

      lottie.loadAnimation({
        container: document.getElementById("animacion-lupa"),
        renderer: "svg",
        loop: true,
        autoplay: true,
        animationData: lottieJson,
      });

      // === Anti-zoom global (mvil + desktop) ===
      (function () {
        // Bloquea gestos de pinch/zoom (iOS Safari)
        const stopGesture = (e) => e.preventDefault();
        window.addEventListener("gesturestart", stopGesture, {
          passive: false,
        });
        window.addEventListener("gesturechange", stopGesture, {
          passive: false,
        });
        window.addEventListener("gestureend", stopGesture, { passive: false });

        // Bloquea Ctrl + rueda (zoom del navegador) en toda la app
        window.addEventListener(
          "wheel",
          (e) => {
            if (e.ctrlKey) {
              e.preventDefault();
              e.stopPropagation();
            }
          },
          { passive: false }
        );

        // Bloquea atajos Ctrl + [+] / [-] / [0] (y numpad)
        document.addEventListener(
          "keydown",
          (e) => {
            if (!e.ctrlKey) return;
            const keys = ["+", "=", "-", "0"];
            if (
              keys.includes(e.key) ||
              [
                "Equal",
                "NumpadAdd",
                "Minus",
                "NumpadSubtract",
                "Digit0",
                "Numpad0",
              ].includes(e.code)
            ) {
              e.preventDefault();
              e.stopPropagation();
            }
          },
          true
        );

        // Asegura poltica de gestos por CSS en runtime
        document.documentElement.style.touchAction = "pan-y";
      })();

      let cabeceras = [];
      let productos = [];
      let indiceTarjetaAbierta = null; // recordar qu tarjeta qued abierta

      // --- Utilidad: guardar/restaurar cach (30 das) ---
      function guardarEnCache() {
        try {
          // Lee la cach previa para no pisar con vacos
          const previaRaw = localStorage.getItem("rupturaCache");
          const previa = previaRaw ? JSON.parse(previaRaw) : {};

          const nombreCampo =
            document.getElementById("campo-nombre")?.textContent?.trim() || "";
          const nombreInput =
            document.getElementById("nombre-usuario")?.value?.trim() || "";
          // Prioriza: campo visible > input > valor ya guardado
          const nombre = nombreCampo || nombreInput || previa.nombre || "";

          const seccionCampo =
            document.getElementById("campo-seccion")?.textContent?.trim() || "";
          // Prioriza: campo visible > valor ya guardado
          const seccion = seccionCampo || previa.seccion || "";

          const datos = {
            nombre,
            seccion,
            productos, // estado actual de tarjetas
            abiertaIndex: indiceTarjetaAbierta, // null o nmero
            scrollY: window.scrollY || 0,
            fecha: new Date().toISOString(),
          };

          localStorage.setItem("rupturaCache", JSON.stringify(datos));
        } catch (e) {
          console.warn("No se pudo guardar en cache:", e);
        }
      }

      function restaurarDeCacheSiAplica() {
        try {
          const cache = localStorage.getItem("rupturaCache");
          if (!cache) return false;

          const datos = JSON.parse(cache);
          const ahora = new Date();
          const guardado = new Date(datos.fecha);
          const dias = (ahora - guardado) / (1000 * 60 * 60 * 24);

          if (dias >= 30) {
            localStorage.removeItem("rupturaCache");
            return false;
          }

          // --- Restaurar datos y UI
          productos = Array.isArray(datos.productos) ? datos.productos : [];

          // Sincroniza input y campos visibles
          const nombre = datos.nombre || "";
          const seccion = datos.seccion || "";

          const inputNombre = document.getElementById("nombre-usuario");
          if (inputNombre) inputNombre.value = nombre;

          document.getElementById("seccion-inicial").style.display = "none";
          document.getElementById("header-principal").style.display = "none";
          document.getElementById("header-secundario").style.display = "block";
          document.getElementById("fecha-header").textContent =
            new Date().toLocaleDateString("es-ES");

          document.getElementById("info-final").style.display = "block";
          document.getElementById("campo-nombre").textContent = nombre;
          document.getElementById("campo-seccion").textContent = seccion;

          indiceTarjetaAbierta = Number.isInteger(datos.abiertaIndex)
            ? datos.abiertaIndex
            : null;

          const contenedor = document.getElementById("contenedor-productos");
          mostrarTarjetas(productos, contenedor, indiceTarjetaAbierta);

          const botonDescargar = document.getElementById("boton-descargar");
          botonDescargar.style.display = "inline-block";
          verificarFormularioCompleto();

          // Restaurar scroll tras pintar
          const y = typeof datos.scrollY === "number" ? datos.scrollY : 0;
          setTimeout(() => {
            window.scrollTo({ top: y, behavior: "auto" });
          }, 50);

          return true;
        } catch (e) {
          console.warn("No se pudo restaurar la cache:", e);
          return false;
        }
      }

      // (se mantiene tu debounce)
      let tGuardar = null;
      function guardarEnCacheDebounced() {
        clearTimeout(tGuardar);
        tGuardar = setTimeout(guardarEnCache, 250);
      }

      document.addEventListener("DOMContentLoaded", () => {
        // Guardar scroll de forma pasiva (debounced)
        window.addEventListener("scroll", guardarEnCacheDebounced, {
          passive: true,
        });
        const inputArchivo = document.getElementById("archivo-excel");
        const inputNombre = document.getElementById("nombre-usuario");
        const botonDescargar = document.getElementById("boton-descargar");
        botonDescargar.disabled = true; // desactivado de primeras

        const contenedor = document.getElementById("contenedor-productos");

        // Intentar restaurar sesin previa (si existe y es reciente)
        const restaurado = restaurarDeCacheSiAplica();

        // Guardar nombre si el usuario lo escribe (opcional pero til)
        inputNombre?.addEventListener("input", guardarEnCacheDebounced);

        // Validar antes de abrir selector de archivo
        document
          .querySelector("label.boton-subir")
          .addEventListener("click", function (e) {
            const nombre = inputNombre.value.trim();

            if (!nombre) {
              alert("Introduce tu nombre antes de continuar");
              e.preventDefault();
              return;
            }

            if (/\d/.test(nombre)) {
              alert("El nombre no puede contener nmeros.");
              e.preventDefault();
              return;
            }
          });

        // SUBIDA DE ARCHIVO
        inputArchivo.addEventListener("change", function () {
          const nombre = inputNombre.value.trim();

          // Mostrar encabezado alternativo
          document.getElementById("seccion-inicial").style.display = "none";
          document.getElementById("header-principal").style.display = "none";
          document.getElementById("header-secundario").style.display = "block";
          document.getElementById("fecha-header").textContent =
            new Date().toLocaleDateString("es-ES");

          const archivo = this.files[0];
          const lector = new FileReader();

          lector.onload = function (e) {
            const datos = new Uint8Array(e.target.result);
            const libro = XLSX.read(datos, { type: "array" });
            const hoja = libro.Sheets[libro.SheetNames[0]];
            const filas = XLSX.utils.sheet_to_json(hoja, { defval: "" });

            if (!filas.length) {
              alert("El archivo no contiene datos.");
              return;
            }

            cabeceras = Object.keys(filas[0]);
            productos = filas;

            // Mostrar seccin colaborador
            document.getElementById("info-final").style.display = "block";
            document.getElementById("campo-nombre").textContent = nombre;
            const secciones = [
              ...new Set(filas.map((f) => f["Seccin"]).filter(Boolean)),
            ];
            document.getElementById("campo-seccion").textContent =
              secciones.length === 1 ? secciones[0] : "varias";

            // Al cargar Excel nuevo: ninguna abierta an
            indiceTarjetaAbierta = null;

            // Mostrar tarjetas
            mostrarTarjetas(productos, contenedor);
            botonDescargar.style.display = "inline-block";
            verificarFormularioCompleto();

            // Guardar estado inicial en cache (incluye seccin)
            guardarEnCache();
          };

          lector.readAsArrayBuffer(archivo);
        });

        // DESCARGAR ARCHIVO MODIFICADO
        botonDescargar.textContent = "Descargar informe de ruptura";

        botonDescargar.addEventListener("click", () => {
          if (!productos.length) {
            alert("Primero debes subir un archivo.");
            return;
          }

          const nombreColaborador =
            document.getElementById("campo-nombre").textContent;
          const fecha = new Date().toLocaleDateString("es-ES");

          // -------------------------
          // Separar productos por AVS
          // -------------------------
          const tieneAVS = (p) => {
            const v = p["Fecha AVS"];
            return (
              v != null && String(v).trim() !== "" && String(v).trim() !== "-"
            );
          };

          // Solo los incluidos en informe
          const productosIncluidos = productos.filter(
            (p) => p["IncluirInforme"] !== false
          );

          const productosSinAVS = productosIncluidos.filter(
            (p) => !tieneAVS(p)
          );

          // Filtrar solo los productos con comentarios vlidos **y** incluidos
          const productosConComentario = productos.filter(
            (p) =>
              p["IncluirInforme"] !== false &&
              p["Comentario"] &&
              p["Comentario"].trim() !== ""
          );

          // Crear seccin de comentarios solo si existen
          let seccionComentarios = [];
          if (productosConComentario.length > 0) {
            seccionComentarios = [
              {
                text: "Comentarios",
                style: "subheader",
                margin: [0, 20, 0, 8],
                color: "#FF5800",
              },
              {
                table: {
                  headerRows: 1,
                  widths: ["auto", "auto", "*"],
                  dontBreakRows: true,
                  body: [
                    [
                      {
                        text: "Referencia",
                        style: "thComentario",
                        alignment: "center",
                      },
                      {
                        text: "Descripcin",
                        style: "thComentario",
                        alignment: "center",
                      },
                      {
                        text: "Comentario",
                        style: "thComentario",
                        alignment: "center",
                      },
                    ],
                    ...productosConComentario.map((p) => [
                      {
                        text: p["Referencia"] || "",
                        fontSize: 9,
                        alignment: "left",
                      },
                      {
                        text: p["Descripcin"] || "",
                        fontSize: 9,
                        alignment: "left",
                      },
                      {
                        text: p["Comentario"] || "",
                        fontSize: 9,
                        alignment: "left",
                      },
                    ]),
                  ],
                },
                layout: {
                  // Cabecera naranja y filas alternadas como la tabla principal
                  fillColor: (rowIndex) => {
                    if (rowIndex === 0) return "#FF5800"; // cabecera
                    return rowIndex % 2 === 1 ? "#FAFAFA" : null; // filas de datos (1,3,5...)
                  },
                  hLineColor: () => "#CCCCCC",
                  vLineColor: () => "#CCCCCC",
                },
              },
            ];
          }

          const buildTablaRupturas = (lista, titulo) => {
            const body = [
              [
                "Ref.",
                "Desc.",
                "Stock Disp.",
                "Stock SV",
                "Dif.",
                "Rect.",
                "Pedir",
                "Prov.",
                "lt. Rec.",
                "Cant. Rec.",
                "Prx. Rec.",
                "Cant. a Rec.",
                "Tot. Ped.",
              ],
              ...lista.map((p) => {
                const stockUbicacionFija =
                  Number(p["Stock Info. Ubicacin Fija"]) || 0;
                const stockRealNum = Number(p["stockReal"]) || 0; // <-- AJUSTA si tu variable/clave se llama distinto

                const diffNum = stockRealNum - stockUbicacionFija;

                const diferenciaCell = {
                  text:
                    diffNum < 0
                      ? `${diffNum}`
                      : diffNum > 0
                      ? `+${diffNum}`
                      : "0",
                  color: diffNum < 0 ? "red" : "green",
                  alignment: "center",
                };

                return [
                  p["Referencia"] || "-",
                  p["Descripcin"] || "-",
                  p["Stock Info. Ubicacin Fija"] ?? "-",
                  stockRealNum || "0",
                  diferenciaCell,
                  p["Rectif."] || p["Rect."] || "-",
                  p["Pedir"] || "-",
                  p["Proveedor"] || "-",
                  p["ltima recepcin"] ||
                    p["Ultima recepcin"] ||
                    p["lt. recepcin"] ||
                    "-",
                  p["Cant. recibida"] || "-",
                  p["Prxima recepcin"] || p["Proxima recepcin"] || "-",
                  p["Cant. recibir"] || "-",
                  p["Total pedidos"] || "-",
                ];
              }),
            ];

            return [
              {
                text: titulo,
                margin: [0, 8, 0, 4],
                bold: true,
                fontSize: 10,
                color: "#FF5800",
              },
              {
                table: {
                  headerRows: 1,
                  widths: [55, "*", 40, 40, 35, 35, 40, 70, 55, 45, 55, 45, 45],
                  body,
                },
                layout: "lightHorizontalLines",
              },
            ];
          };

          // -------------------------
          // Builder tabla rupturas
          // -------------------------
          const tablaRupturas = (lista, titulo) => ({
            stack: [
              {
                text: titulo,
                style: "subheader",
                margin: [0, 0, 0, 8],
                color: "#FF5800",
              },
              {
                table: {
                  headerRows: 1,
                  dontBreakRows: true,
                  widths: [
                    45,
                    150,
                    22,
                    22,
                    30,
                    22,
                    22,
                    38,
                    "*",
                    50,
                    40,
                    50,
                    40,
                    40,
                  ],
                  body: [
                    [
                      { text: "Referencia", style: "th" },
                      { text: "Descripcin", style: "th" },
                      { text: "Stock disp.", style: "th" },
                      { text: "Stock SV", style: "th" },
                      { text: "Stock real", style: "th" },
                      { text: "Dif.", style: "th" },
                      { text: "Rect.", style: "th" },
                      { text: "Pedir", style: "th" },
                      { text: "Proveedor", style: "th" },
                      { text: "ltima recepcin", style: "th" },
                      { text: "Cantidad recibida", style: "th" },
                      { text: "Prxima recepcin", style: "th" },
                      { text: "Cantidad a recibir", style: "th" },
                      { text: "Total pendiente", style: "th" },
                    ],
                    ...lista.map((p, i) => {
                      // stock real (lo mismo que ya usas)
                      const stockReal = p["StockReal"] || "";

                      // rectificado (lo mismo que ya usas)
                      const rectificado = p["Rectificado"] || "";

                      // pedir (lo mismo que ya usas)
                      const pedido = (p["Pedido"] || "").toUpperCase();

                      // diferencia: stockReal - stock SV
                      const stockSV =
                        Number(p["Stock Info. Ubicacin Fija"]) || 0;
                      const stockRealNum = Number(stockReal) || 0;
                      const diffNum = stockRealNum - stockSV;

                      const diferenciaCell = {
                        text:
                          diffNum < 0
                            ? `${diffNum}`
                            : diffNum > 0
                            ? `+${diffNum}`
                            : "0",
                        color: diffNum < 0 ? "red" : "green",
                        alignment: "center",
                      };

                      return [
                        p["Referencia"] || "",
                        p["Descripcin"] || "",
                        p["Stock disponible"] || "",
                        p["Stock Info. Ubicacin Fija"] || "",
                        stockReal,
                        diferenciaCell,
                        rectificado,
                        pedido,
                        p["Proveedor"] || "",
                        p["ltima Recepcin"] || "",
                        p["Qts entregadas ltimo pedido"] || "",
                        p["Fecha prevista entrega"] || "",
                        p["Qts. Prximo pedido"] || "",
                        p["Total Pedido en Curso"] || "",
                      ].map((celda) =>
                        typeof celda === "object"
                          ? {
                              ...celda,
                              fillColor: i % 2 === 0 ? "#FAFAFA" : null,
                              fontSize: 8,
                            }
                          : {
                              text: celda,
                              fillColor: i % 2 === 0 ? "#FAFAFA" : null,
                              alignment: "left",
                              fontSize: 8,
                            }
                      );
                    }),
                  ],
                },
                layout: {
                  fillColor: (rowIndex) => (rowIndex === 0 ? "#120949" : null),
                  hLineColor: () => "#CCCCCC",
                  vLineColor: () => "#CCCCCC",
                },
                margin: [0, 0, 0, 12],
              },
            ],
          });

          const tablaRupturasAVS = (lista, titulo) => ({
            stack: [
              {
                text: titulo,
                style: "subheader",
                margin: [0, 0, 0, 8],
                color: "#000000",
              },
              {
                table: {
                  headerRows: 1,
                  dontBreakRows: true,

                  widths: [45, 150, 22, 22, 30, 22, 22, 48, "*", 50, 40, 40],

                  body: [
                    [
                      { text: "Referencia", style: "thAVS" },
                      { text: "Descripcin", style: "thAVS" },
                      { text: "Stock disp.", style: "thAVS" },
                      { text: "Stock SV", style: "thAVS" },
                      { text: "Stock real", style: "thAVS" },
                      { text: "Dif.", style: "thAVS" },
                      { text: "Rect.", style: "thAVS" },
                      { text: "Fecha AVS", style: "thAVS" },
                      { text: "Proveedor", style: "thAVS" },
                      { text: "Prxima recepcin", style: "thAVS" },
                      { text: "Cantidad a recibir", style: "thAVS" },
                      { text: "Total pendiente", style: "thAVS" },
                    ],

                    ...lista.map((p, i) => {
                      const stockReal = p["StockReal"] || "";
                      const rectificado = p["Rectificado"] || "";
                      const pedido = (p["Pedido"] || "").toUpperCase();

                      const stockSV =
                        Number(p["Stock Info. Ubicacin Fija"]) || 0;
                      const stockRealNum = Number(stockReal) || 0;
                      const diffNum = stockRealNum - stockSV;

                      const diferenciaCell = {
                        text:
                          diffNum < 0
                            ? `${diffNum}`
                            : diffNum > 0
                            ? `+${diffNum}`
                            : "0",
                        color: diffNum < 0 ? "red" : "green",
                        alignment: "center",
                      };

                      const zebra = i % 2 === 0 ? "#FAFAFA" : null;
                      const cell = (text, align = "left") => ({
                        text: text || "",
                        fillColor: zebra,
                        alignment: align,
                        fontSize: 8,
                      });

                      return [
                        cell(p["Referencia"]),
                        cell(p["Descripcin"]),
                        cell(p["Stock disponible"], "center"),
                        cell(p["Stock Info. Ubicacin Fija"], "center"),
                        cell(stockReal, "center"),
                        { ...diferenciaCell, fillColor: zebra, fontSize: 8 },
                        cell(rectificado, "center"),
                        cell(p["Fecha AVS"], "center"),
                        cell(p["Proveedor"] || ""),
                        cell(p["Fecha prevista entrega"], "center"),
                        cell(p["Qts. Prximo pedido"], "center"),
                        cell(p["Total Pedido en Curso"], "center"),
                      ];
                    }),
                  ],
                },
                layout: {
                  fillColor: (rowIndex) => null,
                  hLineColor: () => "#CCCCCC",
                  vLineColor: () => "#CCCCCC",
                },
                margin: [0, 0, 0, 12],
              },
            ],
          });

          const productosConAVS = productosIncluidos.filter(tieneAVS);
          // Crear seccin AVS solo si existen productos con AVS
          let seccionAVS = [];
          if (productosConAVS.length > 0) {
            seccionAVS = [tablaRupturasAVS(productosConAVS, "AVS")];
          }

          const docDefinition = {
            pageOrientation: "landscape",
            pageMargins: [20, 30, 20, 30],
            footer: function (currentPage, pageCount) {
              return {
                columns: [
                  {
                    text: "Creado por Ronald Herrera",
                    alignment: "left",
                    margin: [20, 0, 0, 0],
                    fontSize: 6,
                    color: "#888",
                  },
                  {
                    text: `Pgina ${currentPage} de ${pageCount}`,
                    alignment: "right",
                    margin: [0, 0, 20, 0],
                    fontSize: 9,
                    color: "#555",
                  },
                ],
              };
            },
            content: [
              {
                columns: [
                  { text: "Informe de rupturas", style: "titulo", width: "*" },
                  { image: "logo", width: 30, alignment: "right" },
                ],
              },
              {
                text: `Colaborador/a: ${nombreColaborador}      Fecha: ${fecha}`,
                style: "subheader",
                margin: [0, 0, 0, 15],
              },

              tablaRupturas(productosSinAVS),
              ...seccionAVS,

              ...seccionComentarios,
            ],
            styles: {
              titulo: { fontSize: 18, bold: true, color: "#120949" },
              subheader: { fontSize: 10 },
              th: {
                bold: true,
                color: "white",
                fillColor: "#120949",
                fontSize: 9,
                alignment: "center",
              },

              thAVS: {
                fontSize: 9,
                bold: true,
                color: "#000000",
                fillColor: "#b1b1b1",
                alignment: "center",
              },

              thComentario: {
                bold: true,
                color: "white",
                fillColor: "#FF5800",
                fontSize: 9,
                alignment: "center",
              },
            },
            images: {
              logo: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAArCAYAAADhXXHAAAADSUlEQVR4nNXZPUwTYRgH8P97dQBquEtNMA4csUKMST8Y3cSExOqAkwkmJDChAw6yyGKAgUQYdMGFBYkY4mhMmiYsGEN0lMIAMZC0xAECpm3SyoKvQzkod+/X3ZVc/U/c3Xu9Hw/PPXcAwUmMplRPiJBxCnQDMNAAIcAKNPrusJxZONkGIi0PxkHpRKAyUQiZ+F1JT5IrTakhSsh80B5Z/lJ6VwMhg0FDVBIiZFyjQE/QEJVQoFsLGuEixiWVVWbLn4uGIF9plq5Rwvabv/Di5k/fIF6mN7sws9UpXafUBjObnZje6vKNYkUVCihigYsBu4ECCtipmSenX9cTXAvVjTDef3wpPUfYs7oextORh9CNMEaGXwOoggH46mE79FPmFeKJG9LzhJWNJ6IAgMcDvZidGz3d76fCIqjZcdU7NpY8+27rAbb3qL2isZPieMKaZtu5bT9gO/Tt3KjjR1+3yvoBs6D9A73O6yWue8fqepi53w1YFQpAepNxsboeFvaQCtgNFADavbZBXNLsMrBbKFAtkKhvuXO21bgsxVpgAOfm8OpBBKsHEVdQK7FEFPncHvOYr8rWgmsr7BUKiCcCFxtLqmMBJxhwDwXEE4GLNU1xs7NSC/YCBcQTgUSa71PWgcNK2vWFrORze9IBz0uxWEb02iPmMWZl4y5bwB6vUEA8EZjYdg8tUM/w5ju7sgqTYCO74xpRKpax+jUrXeeqsiqTYHrqA0aG30jXWSkVy+i7N4b05+/StbyJwHwo6Lr8gbCb30d67RsAYHbuuXCtBV3PbqO9o024FuBPBHZl4/LKrq9tAwCWFpeFFa6FAmrtw3tHcGDjySh0g/22ZcX+OOSB7VDr3GKhLPx83kRwYPVWMRSotoA9S4vLuHP72SmEBT07n/3srw1rIjiwrBduezYYAGt/X2oMu7l9LrS6Tt4KrMo6bjD7rzKs5HPOyp5BttF9a0h4/np2B/2Sa5iMG9FTZa2by2t4r4DnHIyJ4MQqTIJSqaLIYkelDVg9y32RacT8T3+fhUaBQtAI1Wga8CNohEoIxRftmNLJoCEqOQ7Rea1wlFlBo4MpnSyUMwvE2jaaUkMhkEFKGua/NwVCsXYMOlE4yqwAwD+4DGJwefgiLgAAAABJRU5ErKJggg==",
            },
          };

          pdfMake.createPdf(docDefinition).getBlob((blob) => {
            const d = new Date();
            const yyyy = d.getFullYear();
            const mm = String(d.getMonth() + 1).padStart(2, "0");
            const dd = String(d.getDate()).padStart(2, "0");

            // Tomar nombre de usuario (prioriza el visible en cabecera)
            const nombreUsuarioRaw = (
              document.getElementById("campo-nombre")?.textContent ||
              document.getElementById("nombre-usuario")?.value ||
              ""
            ).trim();

            // Helper para limpiar texto del nombre
            const slugify = (s) =>
              s
                .normalize("NFD")
                .replace(/[\u0300-\u036f]/g, "")
                .replace(/\s+/g, "_")
                .replace(/[^A-Za-z0-9._-]/g, "")
                .slice(0, 40);

            const nombreLimpio = nombreUsuarioRaw
              ? slugify(nombreUsuarioRaw)
              : "informe";
            const nombreSugeridoFinal = `${nombreLimpio}_Rupturas_${yyyy}.${mm}.${dd}`;

            // --- GUARDAR REFERENCIAS GLOBALES PARA DESCARGA/COMPARTIR ---
            try {
              if (window.__ultimoBlobUrl__)
                URL.revokeObjectURL(window.__ultimoBlobUrl__);
              window.__ultimoBlobUrl__ = URL.createObjectURL(blob);
              window.__ultimoBlobFile__ = blob;
            } catch (e) {
              console.warn("No se pudo crear URL del blob:", e);
            }

            // --- ASEGURAR MODAL ---
            let modal = document.getElementById("modal-visor");
            if (!modal) {
              modal = document.createElement("div");
              modal.id = "modal-visor";
              modal.setAttribute("aria-hidden", "true");
              modal.style.cssText =
                "position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.5);z-index:9999;";
              modal.innerHTML =
                '<div id="contenido-modal" style="background:#fff;width:min(960px,95vw);height:min(90vh,720px);border-radius:10px;box-shadow:0 10px 40px rgba(0,0,0,.3);display:flex;flex-direction:column;overflow:hidden;">' +
                '<div style="display:flex;align-items:center;justify-content:space-between;background:#120949;color:#fff;padding:8px 12px;">' +
                '<strong style="font-family:Roboto,system-ui">Visor del informe</strong>' +
                '<button id="cerrar-modal" aria-label="Cerrar" style="background:transparent;color:#FF5800;border:none;font-size:22px;cursor:pointer"></button>' +
                "</div>" +
                '<div style="display:flex;flex-direction:column;padding:10px;border-bottom:1px solid #eee;">' +
                '<label for="nombre-archivo" style="font:600 12px/1 Roboto,system-ui;color:#333;">Nombre del documento:</label>' +
                `<input id="nombre-archivo" type="text" value="${nombreSugeridoFinal}" style="flex:1;min-width:0;padding:6px 8px;background: #fff7dd;border:1px solid rgba(255, 88, 0, 0.35);border-radius:6px; margin: 2px 0;" />` +
                "</div>" +
                '<div style="padding:8px 12px;text-align:right;border-top:1px solid #eee;display:flex;gap:10px;justify-content: center;">' +
                '<button id="btn-descargar-pdf" style="background:#120949;color:#fff;border:none;padding:8px 10px;border-radius:6px;cursor:pointer;">Descargar</button>' +
                '<button id="btn-compartir" style="background:#FF5800;color:#120949;border:none;padding:8px 10px;border-radius:6px;cursor:pointer;">Compartir</button>' +
                "</div>" +
                "</div>";
              document.body.appendChild(modal);

              // Cerrar modal
              const cerrar = () => {
                if (window.__ultimoBlobUrl__) {
                  URL.revokeObjectURL(window.__ultimoBlobUrl__);
                  window.__ultimoBlobUrl__ = null;
                }
                document.body.style.overflow = "";
                modal.style.display = "none";
              };
              modal.addEventListener("click", (e) => {
                if (e.target === modal) cerrar();
              });
              modal
                .querySelector("#cerrar-modal")
                .addEventListener("click", cerrar);

              // --- DESCARGAR PDF ---
              modal
                .querySelector("#btn-descargar-pdf")
                .addEventListener("click", () => {
                  if (!window.__ultimoBlobUrl__) return;
                  const nombre = (
                    document.getElementById("nombre-archivo").value || "informe"
                  )
                    .replace(/\s+/g, "_")
                    .replace(/[^A-Za-z0-9._-]/g, "");
                  const a = document.createElement("a");
                  a.href = window.__ultimoBlobUrl__;
                  a.download = nombre.endsWith(".pdf")
                    ? nombre
                    : nombre + ".pdf";
                  document.body.appendChild(a);
                  a.click();
                  a.remove();
                });

              // --- ENVIAR POR CORREO ---
              // --- COMPARTIR (Web Share con archivo si es posible, si no: texto + descarga) ---
              modal
                .querySelector("#btn-compartir")
                .addEventListener("click", async () => {
                  const nombre = (
                    document.getElementById("nombre-archivo").value || "informe"
                  )
                    .replace(/\s+/g, "_")
                    .replace(/[^A-Za-z0-9._-]/g, "");
                  const nombreFinal = nombre.endsWith(".pdf")
                    ? nombre
                    : nombre + ".pdf";

                  const blob = window.__ultimoBlobFile__;
                  if (!blob) return; // no hay PDF generado

                  const file = new File([blob], nombreFinal, {
                    type: "application/pdf",
                  });

                  if (
                    navigator.canShare &&
                    navigator.canShare({ files: [file] })
                  ) {
                    try {
                      await navigator.share({
                        files: [file],
                        title: "Informe de ruptura",
                        text: "Informe de ruptura generado.",
                      });
                    } catch (e) {
                      // usuario cancel o fallo; no hacemos nada
                    }
                  } else {
                    // Opcional: simplemente no hacemos nada. Si prefieres avisar:
                    // alert("Compartir archivos no est disponible en este dispositivo/navegador.");
                  }
                });
              const btnCompartir = modal.querySelector("#btn-compartir");
              try {
                const pruebaFile = window.__ultimoBlobFile__
                  ? new File([window.__ultimoBlobFile__], "informe.pdf", {
                      type: "application/pdf",
                    })
                  : null;
                const soportaShareArchivos =
                  !!pruebaFile &&
                  navigator.canShare &&
                  navigator.canShare({ files: [pruebaFile] });

                if (!soportaShareArchivos) {
                  btnCompartir.disabled = true;
                  btnCompartir.title =
                    "Compartir no disponible en este dispositivo/navegador";
                } else {
                  btnCompartir.disabled = false;
                  btnCompartir.title = "";
                }
              } catch {
                btnCompartir.disabled = true;
                btnCompartir.title =
                  "Compartir no disponible en este dispositivo/navegador";
              }
            } else {
              // Si el modal ya existe, solo actualiza el nombre sugerido
              const inputNombre = document.getElementById("nombre-archivo");
              if (inputNombre) inputNombre.value = nombreSugeridoFinal;
            }

            // ================================================
            // NUEVO VISOR PDF COMPATIBLE CON MVILES (PDF.js)
            // ================================================

            // Limpia visor anterior
            const contenidoModal = document.getElementById("contenido-modal");
            let viejoVisor = document.getElementById("pdf-viewer");
            if (viejoVisor) viejoVisor.remove();

            // Crear contenedor
            const visorDiv = document.createElement("div");
            visorDiv.id = "pdf-viewer";
            visorDiv.style.cssText =
              "flex:1;overflow:auto;background:#e9e9e9;padding:4px;display:flex;flex-direction:column;";
            const botonesAccion =
              contenidoModal.querySelector("div:last-child");
            contenidoModal.insertBefore(visorDiv, botonesAccion);

            // Cargar librera PDF.js si no existe
            if (typeof pdfjsLib === "undefined") {
              const script = document.createElement("script");
              script.src =
                "https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js";
              document.head.appendChild(script);
              const worker = document.createElement("script");
              worker.src =
                "https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js";
              document.head.appendChild(worker);
            }

            // Esperar carga de PDF.js
            function esperarPdfjs() {
              return new Promise((resolve) => {
                const check = setInterval(() => {
                  if (window.pdfjsLib) {
                    clearInterval(check);
                    pdfjsLib.GlobalWorkerOptions.workerSrc =
                      "https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js";
                    resolve(pdfjsLib);
                  }
                }, 100);
              });
            }

            // Renderizar PDF
            (async () => {
              const pdfjs = await esperarPdfjs();
              const data = await blob.arrayBuffer();
              const pdf = await pdfjs.getDocument({ data }).promise;

              let scale = 1.1;
              const MIN_SCALE = 0.35; // baja a 0.25 si en mviles pequeos no cabe
              const MAX_SCALE = 3;

              // === PAN ratn ===
              let isMousePanning = false;
              let mStartX = 0,
                mStartY = 0;
              let mScrollLeft = 0,
                mScrollTop = 0;

              // === PAN tctil (1 dedo) ===
              let touchPanning = false;
              let tStartX = 0,
                tStartY = 0;
              let tScrollLeft = 0,
                tScrollTop = 0;

              // === PINCH ===
              let pinchStartDist = null;
              let pinchStartScale = null;
              let pinchVisual = 1;
              let pinchRaf = null;
              let pendingRender = false;

              // Centro del pinch para mantener bajo los dedos
              let pinchCenterX = 0,
                pinchCenterY = 0;
              let pinchStartScrollLeft = 0,
                pinchStartScrollTop = 0;

              // Doble tap
              let baseFitScale = scale;
              let lastTapTime = 0;
              let lastTapX = 0;
              let lastTapY = 0;

              function clamp(v, min, max) {
                return Math.min(max, Math.max(min, v));
              }

              function getDistance(t1, t2) {
                return Math.hypot(
                  t2.clientX - t1.clientX,
                  t2.clientY - t1.clientY
                );
              }

              // === Estilos bsicos del visor ===
              visorDiv.style.touchAction = "none";
              visorDiv.style.overflow = "auto";
              visorDiv.style.cursor = "default";

              // === STAGE (define el tamao real scrollable) + INNER (se escala visualmente) ===
              const stage = document.createElement("div");
              stage.className = "pdf-stage";
              stage.style.position = "relative";
              stage.style.width = "1px";
              stage.style.height = "1px";

              const inner = document.createElement("div");
              inner.className = "pdf-inner";
              inner.style.position = "absolute";
              inner.style.left = "0";
              inner.style.top = "0";
              inner.style.transformOrigin = "0 0";
              inner.style.willChange = "transform";

              // Importante: alineacin a la izquierda (evita centrado raro)
              inner.style.display = "flex";
              inner.style.flexDirection = "column";

              inner.style.gap = "12px";
              inner.style.padding = "6px";

              stage.appendChild(inner);
              visorDiv.appendChild(stage);

              function updateStageSize(visualFactor = 1) {
                // stage define el rea scrollable REAL
                const w = Math.ceil(inner.scrollWidth * visualFactor);
                const h = Math.ceil(inner.scrollHeight * visualFactor);
                stage.style.width = `${Math.max(1, w)}px`;
                stage.style.height = `${Math.max(1, h)}px`;
              }

              async function fitToPage() {
                const page1 = await pdf.getPage(1);
                const viewport = page1.getViewport({ scale: 1 });

                const paddingX = 28; // espacio para sombras/mrgenes
                const paddingY = 28;

                const containerW = Math.max(
                  80,
                  visorDiv.clientWidth - paddingX
                );
                const containerH = Math.max(
                  80,
                  visorDiv.clientHeight - paddingY
                );

                const scaleW = containerW / viewport.width;
                const scaleH = containerH / viewport.height;

                scale = clamp(Math.min(scaleW, scaleH), MIN_SCALE, MAX_SCALE);
                baseFitScale = scale;
              }

              async function renderAllPages() {
                // NO borres visorDiv. Solo inner.
                inner.innerHTML = "";

                for (let num = 1; num <= pdf.numPages; num++) {
                  const page = await pdf.getPage(num);
                  const viewport = page.getViewport({ scale });

                  const canvas = document.createElement("canvas");
                  const ctx = canvas.getContext("2d");

                  const dpr = window.devicePixelRatio || 1;
                  canvas.width = Math.floor(viewport.width * dpr);
                  canvas.height = Math.floor(viewport.height * dpr);
                  canvas.style.width = Math.floor(viewport.width) + "px";
                  canvas.style.height = Math.floor(viewport.height) + "px";

                  await page.render({
                    canvasContext: ctx,
                    viewport,
                    transform: dpr !== 1 ? [dpr, 0, 0, dpr, 0, 0] : undefined,
                  }).promise;

                  const pageWrap = document.createElement("div");
                  pageWrap.className = "pdf-sheet";
                  pageWrap.style.cssText =
                    "background:#fff;border:1px solid #e5e5e5;box-shadow:0 8px 24px rgba(0,0,0,.18);";

                  pageWrap.appendChild(canvas);
                  inner.appendChild(pageWrap);
                }

                // Reset visual scaling (si venamos de pinch)
                inner.style.transform = "scale(1)";
                inner.style.willChange = "auto";
                updateStageSize(1);

                visorDiv.style.cursor =
                  scale > baseFitScale ? "grab" : "default";
              }

              // Zoom hacia un punto (para PC wheel / doble tap)
              function zoomToPoint(newScale, clientX, clientY) {
                const rect = visorDiv.getBoundingClientRect();
                const x = clientX - rect.left + visorDiv.scrollLeft;
                const y = clientY - rect.top + visorDiv.scrollTop;

                const ratio = newScale / scale;

                visorDiv.scrollLeft = x * ratio - (x - visorDiv.scrollLeft);
                visorDiv.scrollTop = y * ratio - (y - visorDiv.scrollTop);

                scale = newScale;
              }

              // === INIT ===
              await fitToPage();
              await renderAllPages();

              /* ===== ZOOM CTRL+RUEDA (PC) ===== */
              visorDiv.addEventListener(
                "wheel",
                async (e) => {
                  if (!e.ctrlKey) return;
                  e.preventDefault();

                  const delta = e.deltaY > 0 ? -0.1 : 0.1;
                  const newScale = clamp(scale + delta, MIN_SCALE, MAX_SCALE);

                  zoomToPoint(newScale, e.clientX, e.clientY);
                  await renderAllPages();
                },
                { passive: false }
              );

              /* ===== PAN RATN (PC) ===== */
              visorDiv.addEventListener("mousedown", (e) => {
                if (scale <= baseFitScale) return;

                isMousePanning = true;
                visorDiv.style.cursor = "grabbing";

                mStartX = e.pageX;
                mStartY = e.pageY;
                mScrollLeft = visorDiv.scrollLeft;
                mScrollTop = visorDiv.scrollTop;
              });

              visorDiv.addEventListener("mousemove", (e) => {
                if (!isMousePanning) return;
                e.preventDefault();

                const dx = e.pageX - mStartX;
                const dy = e.pageY - mStartY;

                visorDiv.scrollLeft = mScrollLeft - dx;
                visorDiv.scrollTop = mScrollTop - dy;
              });

              ["mouseup", "mouseleave"].forEach((evt) => {
                visorDiv.addEventListener(evt, () => {
                  isMousePanning = false;
                  visorDiv.style.cursor =
                    scale > baseFitScale ? "grab" : "default";
                });
              });

              /* ===== PAN TCTIL (1 dedo) ===== */
              visorDiv.addEventListener(
                "touchstart",
                (e) => {
                  if (
                    e.touches.length === 1 &&
                    scale > baseFitScale &&
                    pinchStartDist === null
                  ) {
                    touchPanning = true;
                    tStartX = e.touches[0].clientX;
                    tStartY = e.touches[0].clientY;
                    tScrollLeft = visorDiv.scrollLeft;
                    tScrollTop = visorDiv.scrollTop;
                    e.preventDefault();
                  }
                },
                { passive: false }
              );

              visorDiv.addEventListener(
                "touchmove",
                (e) => {
                  if (!touchPanning) return;
                  if (e.touches.length !== 1) return;

                  e.preventDefault();

                  const x = e.touches[0].clientX;
                  const y = e.touches[0].clientY;
                  const dx = x - tStartX;
                  const dy = y - tStartY;

                  visorDiv.scrollLeft = tScrollLeft - dx;
                  visorDiv.scrollTop = tScrollTop - dy;
                },
                { passive: false }
              );

              ["touchend", "touchcancel"].forEach((evt) => {
                visorDiv.addEventListener(
                  evt,
                  () => {
                    touchPanning = false;
                  },
                  { passive: true }
                );
              });

              /* ===== PINCH (MVIL)  natural + con scroll real ===== */
              visorDiv.addEventListener(
                "touchstart",
                (e) => {
                  if (e.touches.length === 2) {
                    e.preventDefault();
                    touchPanning = false;

                    pinchStartDist = getDistance(e.touches[0], e.touches[1]);
                    pinchStartScale = scale;
                    pinchVisual = 1;

                    const rect = visorDiv.getBoundingClientRect();
                    pinchCenterX =
                      (e.touches[0].clientX + e.touches[1].clientX) / 2 -
                      rect.left +
                      visorDiv.scrollLeft;
                    pinchCenterY =
                      (e.touches[0].clientY + e.touches[1].clientY) / 2 -
                      rect.top +
                      visorDiv.scrollTop;

                    pinchStartScrollLeft = visorDiv.scrollLeft;
                    pinchStartScrollTop = visorDiv.scrollTop;

                    inner.style.willChange = "transform";
                  }
                },
                { passive: false }
              );

              visorDiv.addEventListener(
                "touchmove",
                (e) => {
                  if (e.touches.length !== 2 || pinchStartDist === null) return;
                  e.preventDefault();

                  const dist = getDistance(e.touches[0], e.touches[1]);
                  const ratio = dist / pinchStartDist;
                  pinchVisual = clamp(ratio, 0.5, 2.2);

                  if (!pinchRaf) {
                    pinchRaf = requestAnimationFrame(() => {
                      // zoom visual suave
                      inner.style.transform = `scale(${pinchVisual})`;

                      // MUY IMPORTANTE: ahora el scroll tambin tiene rango real
                      updateStageSize(pinchVisual);

                      // mantener el centro del pinch fijo ajustando scroll
                      const targetLeft =
                        pinchCenterX * pinchVisual -
                        (pinchCenterX - pinchStartScrollLeft);
                      const targetTop =
                        pinchCenterY * pinchVisual -
                        (pinchCenterY - pinchStartScrollTop);

                      visorDiv.scrollLeft = targetLeft;
                      visorDiv.scrollTop = targetTop;

                      pinchRaf = null;
                    });
                  }
                },
                { passive: false }
              );

              async function commitPinch() {
                if (pinchStartDist === null) return;

                const newScale = clamp(
                  pinchStartScale * pinchVisual,
                  MIN_SCALE,
                  MAX_SCALE
                );

                pinchStartDist = null;
                pinchStartScale = null;

                // Mantn el transform mientras renderiza para que no parpadee
                if (pendingRender) return;
                pendingRender = true;

                // Scale real final
                scale = newScale;

                await renderAllPages();

                pendingRender = false;
              }

              visorDiv.addEventListener("touchend", commitPinch);
              visorDiv.addEventListener("touchcancel", commitPinch);

              /* ===== DOBLE TAP (MVIL): zoom / volver a fit ===== */
              visorDiv.addEventListener(
                "touchend",
                async (e) => {
                  // no interferir con pinch
                  if (pinchStartDist !== null) return;
                  if (e.changedTouches.length !== 1) return;

                  const now = Date.now();
                  const touch = e.changedTouches[0];
                  const x = touch.clientX;
                  const y = touch.clientY;

                  const dt = now - lastTapTime;
                  const dx = Math.abs(x - lastTapX);
                  const dy = Math.abs(y - lastTapY);

                  if (dt < 280 && dx < 28 && dy < 28) {
                    lastTapTime = 0;

                    const isZoomed = scale > baseFitScale + 0.01;

                    if (!isZoomed) {
                      const target = clamp(
                        baseFitScale * 1.6,
                        MIN_SCALE,
                        MAX_SCALE
                      );
                      zoomToPoint(target, x, y);
                    } else {
                      scale = baseFitScale;
                      visorDiv.scrollLeft = 0;
                      visorDiv.scrollTop = 0;
                    }

                    await renderAllPages();
                    return;
                  }

                  lastTapTime = now;
                  lastTapX = x;
                  lastTapY = y;
                },
                { passive: false }
              );

              /* ===== RESIZE / ROTACIN ===== */
              let resizeTimer;
              window.addEventListener(
                "resize",
                () => {
                  clearTimeout(resizeTimer);
                  resizeTimer = setTimeout(async () => {
                    await fitToPage();
                    await renderAllPages();
                    visorDiv.scrollLeft = 0;
                    visorDiv.scrollTop = 0;
                  }, 150);
                },
                { passive: true }
              );
            })();

            // Abrir modal
            modal.style.display = "flex";
            document.body.style.overflow = "hidden";
          });
        });

        // BOTN REINICIAR
        document
          .getElementById("boton-reiniciar")
          .addEventListener("click", () => {
            const inputArchivo = document.getElementById("archivo-excel");
            inputArchivo.value = ""; // limpiar el anterior
            inputArchivo.click(); // abrir selector
          });

        // BOTN VOLVER A LA PANTALLA INICIAL
        const botonVolver = document.getElementById("boton-volver");
        if (botonVolver) {
          botonVolver.addEventListener("click", () => {
            // Mostrar pantallas iniciales
            const seccionInicial = document.getElementById("seccion-inicial");
            const headerPrincipal = document.getElementById("header-principal");
            const headerSecundario =
              document.getElementById("header-secundario");
            const infoFinal = document.getElementById("info-final");
            const contenedorProductos = document.getElementById(
              "contenedor-productos"
            );
            const inputArchivo = document.getElementById("archivo-excel");
            const inputNombre = document.getElementById("nombre-usuario");
            const botonDescargar = document.getElementById("boton-descargar");

            if (seccionInicial) seccionInicial.style.display = "block";
            if (headerPrincipal) headerPrincipal.style.display = "block";
            if (headerSecundario) headerSecundario.style.display = "none";
            if (infoFinal) infoFinal.style.display = "none";
            if (contenedorProductos) contenedorProductos.innerHTML = "";

            // Reset estado de app
            cabeceras = [];
            productos = [];
            indiceTarjetaAbierta = null;

            if (inputArchivo) inputArchivo.value = "";
            if (inputNombre) inputNombre.value = "";
            if (botonDescargar) {
              botonDescargar.style.display = "none";
              botonDescargar.disabled = true;
              botonDescargar.textContent = "Generar informe de ruptura";
            }

            // Limpiar cach explcitamente
            localStorage.removeItem("rupturaCache");

            // Subir arriba por si el usuario estaba abajo
            window.scrollTo({ top: 0, behavior: "smooth" });
          });
        }

        // Si restauramos de cache, ya se mostraron tarjetas arriba
        if (!restaurado) {
          // No hacer nada extra
        }
      });

      // MOSTRAR TARJETAS (con opcin de abrir una por ndice)
      function mostrarTarjetas(lista, contenedor, indiceAbrir = null) {
        contenedor.innerHTML = "";

        lista.forEach((p, i) => {
          const tarjeta = document.createElement("div");
          tarjeta.className = "tarjeta";
          tarjeta.dataset.abierta = "false";

          const ventas = [
            "Ventas M-3",
            "Ventas M-2",
            "Ventas M-1",
            "Ventas M",
            "Ventas M A-1",
          ].map((k) => p[k] || 0);

          // Asegurar valor inicial del toggle (por defecto incluido)
          if (typeof productos[i]["IncluirInforme"] === "undefined") {
            productos[i]["IncluirInforme"] = true;
          }

          // Asegurar campos persistidos
          // Default stock real = Stock en ubicacin fija
          const stockUbiFija = p["Stock Info. Ubicacin Fija"] ?? "";

          // Si no hay StockReal guardado todava, poner el de ubicacin fija
          if (
            typeof productos[i]["StockReal"] === "undefined" ||
            productos[i]["StockReal"] === ""
          ) {
            productos[i]["StockReal"] = stockUbiFija;
          }

          // Rectificado por defecto = "No" (salvo que luego se modifique StockReal)
          if (
            typeof productos[i]["Rectificado"] === "undefined" ||
            productos[i]["Rectificado"] === ""
          ) {
            productos[i]["Rectificado"] = "No";
          }

          // --- Badge AVS (solo si hay fecha AVS) ---
          const avsRaw = p["Fecha AVS"];
          const tieneAVS =
            avsRaw != null &&
            String(avsRaw).trim() !== "" &&
            String(avsRaw).trim() !== "-";
          const badgeAVS = tieneAVS ? `<span class="badge-avs">AVS</span>` : "";

          const stockUbicacionFija = String(
            p["Stock Info. Ubicacin Fija"] ?? ""
          );

          tarjeta.innerHTML = `
            <div class="tarjeta-titulo">
              <div class="nombre">
              <img class="toggle-icon" src="https://ronaldherrera.es/proyectos/Obramat/Control-rupturas/recursos/flecha_desplegar.svg" alt="">
              <strong>${p["Descripcin"]}</strong>
            </div></div>
            <div class="tarjeta-cabecera">
          <div class="cabecera-izquierda">
            <div class="ean">
              <div  style="display:flex; flex-direction: row;
      align-items: flex-end;">Ref. <em>${p["Referencia"]}</em>
              <div style="margin-left: 8px; font-size: 12px;">(Stock disponible ${
                p["Stock disponible"]
              })</div></div>
              <label class="switch-informe">
                <input type="checkbox" class="toggle-informe" data-indice="${i}" ${
            productos[i]["IncluirInforme"] ? "checked" : ""
          }>
                <span class="slider-text" aria-live="polite"></span>
              </label>
            </div>
          </div>
          <div class="cabecera-derecha">
            <div class="stock"><span>Stock en SV:</span> ${
              p["Stock Info. Ubicacin Fija"]
            } </div>

            ${badgeAVS}
          </div>

        </div>
        <div class="tarjeta-detalle">
          <div class="detalle-proveedor">
            <span>PROVEEDOR:</span> ${p["Proveedor"] || ""}<br>
            <span>PLAZO DE ENTREGA:</span> ${p["Plazo de Entrega"] || ""} das
          </div>
          <div class="detalle-ubicacion">
            <div>
              <span>EAN: </span><br>${p["EAN"] || ""}<br>
              <span>Ubi.: </span><i style=" font-size: 10px;">${
                p["Ubicacin fija"] || ""
              }</i><br>
            </div>
            <div>
              <span>AVS: </span> <i style="color: #FF5800;">${
                p["Fecha AVS"] || "-"
              }</i><br>
              <span>LTIMA RECEPCIN: </span><br>
              ${
                p["ltima Recepcin"] || "-"
              }>> <strong style="color: #FF5800;">${
            p["Qts entregadas ltimo pedido"] || "-"
          }</strong>
            </div>
          </div>
          <div class="detalle-ventas">
            <span>VENTAS</span>
            <table>
              <tr>
                <th>M-3</th><th>M-2</th><th>M-1</th><th>M</th><th>M A-1</th>
              </tr>
              <tr>
                <td>${p["Ventas M-3"] || 0}</td>
                <td>${p["Ventas M-2"] || 0}</td>
                <td>${p["Ventas M-1"] || 0}</td>
                <td>${p["Ventas M"] || 0}</td>
                <td>${p["Ventas M A-1"] || 0}</td>
              </tr>
            </table>
          </div>
          <div class="detalle-pedidos">
            <span>PEDIDOS EN<br>CURSO</span><br>
            <strong style="font-size: 20px;">${
              p["Total Pedido en Curso"] || ""
            }</strong>
          </div>
          <div class="detalle-proximo">
            <div>
              <span>PRXIMO PEDIDO</span><br>
              <strong style="font-size: 10px; font-weight: 400;">${
                p["Prximo pedido"] || ""
              } >> </strong>
              <strong style="font-size: 12px; font-weight: 600; color:#120949;">${
                p["Fecha prevista entrega"] || ""
              }</strong>
            </div>
            <strong style="font-size: 20px;">${
              p["Qts. Prximo pedido"] || "NO SE ESPERA"
            }</strong>
          </div>
          <div class="detalle-causa">
            <span>POSIBLE CAUSA DE LA RUPTURA:</span><br>
            <strong style="font-size: 10px; font-weight: 400;">${
              p["Posible Causa de la Ruptura"] || ""
            }</strong>
          </div>
          <div class="detalle-edita">
            <span>SE EDITA:</span><br>
            <strong style="font-size: 10px; font-weight: 400;">${
              p["Da de edicin"] || ""
            }</strong>
          </div>
        </div>
        <div class="tarjeta-pie">
          <div class="tarjeta-pie1">
            <div class="grupo-stock">
              <span>  Stock real en sv:</span>
              <label> <input class="stock-real" type="number" data-indice="${i}" /></label>
              </div>
            
            <div class="grupo-radio">
              <span>Rectificado:</span>
              <div>
              <label>S<input type="radio" name="r${i}" value="S" /></label>
              <label>No<input type="radio" name="r${i}" value="No" /></label>
              </div>
            </div>
            <button class="btn-decision">Pedir/No pedir</button>
          </div>
          <textarea class="comentario-input" data-indice="${i}" placeholder="Aade un comentario (opcional)" rows="1">${
            p["Comentario"] || ""
          }</textarea>
        </div>`;

          // Estado del botn pedir/no pedir
          const boton = tarjeta.querySelector(".btn-decision");
          const estado = productos[i]["Pedido"] || "neutro";
          if (estado === "pedir") {
            boton.classList.add("estado-pedir");
            boton.textContent = "Pedir";
          } else if (estado === "nopedir") {
            boton.classList.add("estado-nopedir");
            boton.textContent = "No pedir";
          } else {
            boton.classList.add("estado-neutro");
            boton.textContent = "Pedir/No pedir";
          }

          boton.addEventListener("click", () => {
            const actual = productos[i]["Pedido"];
            if (actual === "pedir") {
              productos[i]["Pedido"] = "nopedir";
              boton.className = "btn-decision estado-nopedir";
              boton.textContent = "No pedir";
            } else {
              productos[i]["Pedido"] = "pedir";
              boton.className = "btn-decision estado-pedir";
              boton.textContent = "Pedir";
            }

            verificarFormularioCompleto();

            // Aadir animacin pulse
            boton.classList.add("animar");
            setTimeout(() => boton.classList.remove("animar"), 300);

            guardarEnCacheDebounced();
          });

          const cabecera = tarjeta.querySelector(".tarjeta-cabecera");
          const icono = tarjeta.querySelector(".toggle-icon");

          cabecera.addEventListener("click", () => {
            const abierta = tarjeta.dataset.abierta === "true";

            // Cerrar todas
            document.querySelectorAll(".tarjeta").forEach((t) => {
              t.dataset.abierta = "false";
              const icono = t.querySelector(".toggle-icon");
              if (icono) icono.style.transform = "rotate(0deg)";
            });

            if (!abierta) {
              tarjeta.dataset.abierta = "true";
              icono.style.transform = "rotate(180deg)";
              indiceTarjetaAbierta = i; // recordar cul qued abierta
            } else {
              indiceTarjetaAbierta = null; // ninguna abierta
            }
            guardarEnCacheDebounced(); // persistimos
          });

          contenedor.appendChild(tarjeta);

          // --- Abrir automticamente la tarjeta guardada ---
          if (indiceAbrir === i) {
            tarjeta.dataset.abierta = "true";
            const iconoAuto = tarjeta.querySelector(".toggle-icon");
            if (iconoAuto) iconoAuto.style.transform = "rotate(180deg)";
          }

          // --- Campos persistidos: STOCK REAL ---
          const inputStock = tarjeta.querySelector(".stock-real");
          // valor inicial desde productos
          if (
            productos[i]["StockReal"] !== undefined &&
            productos[i]["StockReal"] !== ""
          ) {
            inputStock.value = productos[i]["StockReal"];
          }
          inputStock.addEventListener("input", (e) => {
            const nuevo = String(e.target.value);
            productos[i]["StockReal"] = nuevo;

            //  CASO 1: vuelve exactamente al stock de ubicacin fija
            if (nuevo === stockUbicacionFija) {
              productos[i]["Rectificado"] = "No";

              const radios = tarjeta.querySelectorAll(`input[name="r${i}"]`);
              radios.forEach((r) => {
                r.checked = r.value === "No";
              });
            }
            //  CASO 2: es distinto  obligar a decidir
            else {
              productos[i]["Rectificado"] = "";

              const radios = tarjeta.querySelectorAll(`input[name="r${i}"]`);
              radios.forEach((r) => (r.checked = false));
            }

            verificarFormularioCompleto();
            guardarEnCacheDebounced();
          });
          const stockInicial = String(productos[i]["StockReal"] ?? "");

          // Bloquear letras, signos y flechas arriba/abajo en stock
          inputStock.addEventListener("keydown", (e) => {
            const teclasPermitidas = [
              "Backspace",
              "ArrowLeft",
              "ArrowRight",
              "Tab",
              "Delete",
            ];
            const esNumero = /^[0-9]$/.test(e.key);

            if (!esNumero && !teclasPermitidas.includes(e.key)) {
              e.preventDefault();
            }

            // Bloquear flechas arriba/abajo
            if (e.key === "ArrowUp" || e.key === "ArrowDown") {
              e.preventDefault();
            }
          });

          // Prevenir pegado de cosas raras
          inputStock.addEventListener("paste", (e) => {
            const texto = e.clipboardData.getData("text");
            if (!/^\d+$/.test(texto)) {
              e.preventDefault();
            }
          });

          // --- Comentario (persistente) ---
          const comentario = tarjeta.querySelector(".comentario-input");
          comentario.addEventListener("input", (e) => {
            productos[i]["Comentario"] = e.target.value.trim();

            // auto-ajuste de altura
            comentario.style.height = "auto";
            comentario.style.height = comentario.scrollHeight + "px";

            guardarEnCacheDebounced();
          });

          // Ajuste inicial por si ya hay comentario cargado
          comentario.style.height = "auto";
          comentario.style.height = comentario.scrollHeight + "px";

          // --- Rectificado (persistente) ---
          const radios = tarjeta.querySelectorAll(`input[name="r${i}"]`);
          // marcar estado inicial si existe
          if (p["Rectificado"] === "S") {
            radios[0].checked = true;
          } else if (p["Rectificado"] === "No") {
            radios[1].checked = true;
          }
          radios.forEach((r) =>
            r.addEventListener("change", (e) => {
              productos[i]["Rectificado"] = e.target.value; // "S" | "No"
              verificarFormularioCompleto();
              guardarEnCacheDebounced();
            })
          );

          // ---- SWITCH INCLUIR/EXCLUIR EN INFORME (persistente) ----
          const toggle = tarjeta.querySelector(".toggle-informe");
          if (toggle) {
            // Inicializar segn el dato guardado
            toggle.checked = productos[i]["IncluirInforme"] !== false;
            productos[i]["IncluirInforme"] = toggle.checked;

            // Cambios en tiempo real
            toggle.addEventListener("change", (e) => {
              productos[i]["IncluirInforme"] = e.target.checked;
              verificarFormularioCompleto();
              guardarEnCacheDebounced();
            });
          }
        });

        // Guardar un snapshot tras pintar (por si venimos de Excel/restauracin)
        guardarEnCacheDebounced();
      }

      function verificarFormularioCompleto() {
        const botonDescargar = document.getElementById("boton-descargar");
        const tarjetas = document.querySelectorAll(".tarjeta");

        const todasCompletas = productos.every((p, i) => {
          // Excluidos no bloquean
          if (p["IncluirInforme"] === false) return true;

          const tarjeta = tarjetas[i];
          // Si no hay tarjeta pintada an, usa lo guardado
          const stock =
            tarjeta?.querySelector(`input.stock-real[data-indice="${i}"]`)
              ?.value ??
            p["StockReal"] ??
            "";
          const rectif =
            tarjeta?.querySelector(`input[name="r${i}"]:checked`)?.value ||
            p["Rectificado"] ||
            "";
          const pedir = p["Pedido"];

          return (
            stock !== "" && rectif && (pedir === "pedir" || pedir === "nopedir")
          );
        });

        // Nueva condicin: si todas las tarjetas estn excluidas, tambin desactiva el botn
        const todasExcluidas = productos.every(
          (p) => p["IncluirInforme"] === false
        );

        botonDescargar.disabled = !todasCompletas || todasExcluidas;
        botonDescargar.textContent = todasCompletas
          ? "Generar informe de ruptura"
          : "Completa todas las tarjetas para activarme";
      }

      // DESCARGAR ARCHIVO MODIFICADO
      botonDescargar.textContent = "Descargar informe de ruptura";

      // --- utilidades del modal/visor ---
      let ultimoBlobUrl = null;
      let ultimoArchivo = null;

      function abrirModal() {
        const modal = document.getElementById("modal-visor");
        modal.setAttribute("aria-hidden", "false");
        // Evita scroll del body
        document.body.style.overflow = "hidden";
      }
      function cerrarModal() {
        const modal = document.getElementById("modal-visor");
        modal.setAttribute("aria-hidden", "true");
        document.body.style.overflow = "";
        // Limpieza de blob URL para no filtrar memoria
        const visor = document.getElementById("visor-pdf");
        if (ultimoBlobUrl) URL.revokeObjectURL(ultimoBlobUrl);
        ultimoBlobUrl = null;
        ultimoArchivo = null;
        visor.src = "about:blank";
      }
      // listeners estticos del modal
      document
        .getElementById("cerrar-modal")
        .addEventListener("click", cerrarModal);
      document
        .getElementById("btn-cerrar-modal")
        .addEventListener("click", cerrarModal);

      botonDescargar.addEventListener("click", () => {
        if (!productos.length) {
          alert("Primero debes subir un archivo.");
          return;
        }

        const nombreColaborador =
          document.getElementById("campo-nombre").textContent;
        const fecha = new Date().toLocaleDateString("es-ES");

        // ... aqu mantn todo tu clculo de productosConComentario y docDefinition ...

        const docDefinition = {
          /*  tu definicin exacta (sin cambios) */
        };
      });

      // Accin: Descargar (usa el nombre del input)
      document
        .getElementById("btn-descargar-pdf")
        .addEventListener("click", () => {
          if (!ultimoBlobUrl) return;
          const nombre = (
            document.getElementById("nombre-archivo").value || "informe.pdf"
          )
            .replace(/\s+/g, "_")
            .replace(/[^A-Za-z0-9._-]/g, "");
          const a = document.createElement("a");
          a.href = ultimoBlobUrl;
          a.download = nombre.endsWith(".pdf") ? nombre : `${nombre}.pdf`;
          document.body.appendChild(a);
          a.click();
          a.remove();
        });
    </script>

    <!----------------------------------------------------------------------------->
    <script>
      (function () {
        function openModal(id) {
          const m = document.getElementById(id);
          if (!m) return;
          m.setAttribute("aria-hidden", "false");
          document.body.style.overflow = "hidden";
        }

        function closeModal(id) {
          const m = document.getElementById(id);
          if (!m) return;
          m.setAttribute("aria-hidden", "true");
          document.body.style.overflow = "";
        }

        // Delegacin: detecta clicks en cualquier parte
        document.addEventListener(
          "click",
          function (e) {
            const openBtn = e.target.closest("[data-open]");
            if (openBtn) {
              const id = openBtn.getAttribute("data-open");
              openModal(id);
              return;
            }

            const closeBtn = e.target.closest("[data-close]");
            if (closeBtn) {
              const id = closeBtn.getAttribute("data-close");
              closeModal(id);
            }
          },
          true
        ); // <- CAPTURING: incluso si algo para la propagacin
      })();
    </script>

    <!-- ===== Footer fijo ===== -->
    <footer class="footer">
      <div class="footer-inner">
        <button class="footer-link" type="button" data-open="modal-creditos">
          <strong></strong> Crditos
        </button>

        <button class="footer-link" type="button" data-open="modal-ayuda">
          <strong></strong> Ayuda
        </button>

        <button class="footer-link" type="button" data-open="modal-qr">
          <strong></strong> Compartir
        </button>
      </div>
    </footer>

    <!-- ===== Modal Ayuda ===== -->
    <div class="modal-mini" id="modal-ayuda" aria-hidden="true">
      <div class="modal-capa" data-close="modal-ayuda"></div>
      <div
        class="modal-caja"
        role="dialog"
        aria-modal="true"
        aria-label="Ayuda"
      >
        <div class="modal-header">
          <h3>Tutorial</h3>
          <button class="modal-cerrar" type="button" data-close="modal-ayuda">
            
          </button>
        </div>
        <div class="modal-body">
          <div class="ayuda-slider" data-slider="ayuda">
            <div class="ayuda-track" data-track>
              <section class="ayuda-step" data-step>
                <h4>1. Identifcate y sube el archivo</h4>
                <div class="ayuda-media">
                  <img
                    src="https://ronaldherrera.es/proyectos/Obramat/Control-rupturas/recursos/Tutorial/tuto-1.gif"
                    alt="Formulario inicial: nombre y subida del archivo"
                  />
                </div>
                <p>
                  Escribe tu <strong>nombre</strong> y sube el
                  <strong>archivo de ruptura</strong> que Solex te enva por
                  correo. Descrgalo y sbelo a la app.
                </p>
                <p class="ayuda-nota">
                  Sin este archivo no se puede continuar.
                </p>
              </section>

              <section class="ayuda-step" data-step>
                <h4>2. Tarjetas de productos</h4>
                <div class="ayuda-media">
                  <img
                    src="https://ronaldherrera.es/proyectos/Obramat/Control-rupturas/recursos/Tutorial/tuto-2.gif"
                    alt="Formulario inicial: nombre y subida del archivo"
                  />
                </div>
                <p>
                  Al cargar el archivo, aparecern las
                  <strong>tarjetas de los productos en ruptura</strong>. Sin
                  tocar nada puedes ver informacin relevante para una primera
                  revisin.
                </p>
              </section>

              <section class="ayuda-step" data-step>
                <h4>3. Ver informacin detallada</h4>
                <div class="ayuda-media">
                  <img
                    src="https://ronaldherrera.es/proyectos/Obramat/Control-rupturas/recursos/Tutorial/tuto-3.gif"
                    alt="Formulario inicial: nombre y subida del archivo"
                  />
                </div>
                <p>
                  Si pulsas sobre una tarjeta, se despliega informacin ms
                  completa:
                </p>
                <ul>
                  <li>Proveedor</li>
                  <li>Ventas de los ltimos meses</li>
                  <li>ltimas y prximas recepciones</li>
                  <li>Otros datos relevantes</li>
                </ul>
              </section>

              <section class="ayuda-step" data-step>
                <h4>4. Incluir o excluir del informe</h4>
                <div class="ayuda-media">
                  <img
                    src="https://ronaldherrera.es/proyectos/Obramat/Control-rupturas/recursos/Tutorial/tuto-4.gif"
                    alt="Formulario inicial: nombre y subida del archivo"
                  />
                </div>
                <p>
                  Cada tarjeta tiene un botn para
                  <strong>incluir o excluir</strong> el producto del informe
                  final.
                </p>
                <p>
                  Solo los productos incluidos aparecern en el informe. Puedes
                  cambiar esta decisin cuando quieras.
                </p>
              </section>

              <section class="ayuda-step" data-step>
                <h4>5. Completar el pie de la tarjeta</h4>
                <div class="ayuda-media">
                  <img
                    src="https://ronaldherrera.es/proyectos/Obramat/Control-rupturas/recursos/Tutorial/tuto-5.gif"
                    alt="Formulario inicial: nombre y subida del archivo"
                  />
                </div>
                <p>En el pie editable de cada tarjeta debes indicar:</p>
                <ul>
                  <li>
                    <strong>Stock real en sala de venta</strong><br /><small
                      >Viene relleno por defecto para agilizar.</small
                    >
                  </li>
                  <li>
                    <strong>Rectificado en Solex: S / No</strong> <br /><small
                      >Viene relleno por defecto para agilizar.</small
                    >
                  </li>
                  <li><strong>Pedir / No pedir</strong> (obligatorio)</li>
                </ul>
              </section>

              <section class="ayuda-step" data-step>
                <h4>6. Comentario (opcional)</h4>
                <div class="ayuda-media">
                  <img
                    src="https://ronaldherrera.es/proyectos/Obramat/Control-rupturas/recursos/Tutorial/tuto-6.gif"
                    alt="Formulario inicial: nombre y subida del archivo"
                  />
                </div>
                <p>
                  Puedes aadir un <strong>comentario</strong> si necesitas
                  dejar una aclaracin o informacin extra.
                </p>
              </section>

              <section class="ayuda-step" data-step>
                <h4>7. Generar informe</h4>
                <div class="ayuda-media">
                  <img
                    src="https://ronaldherrera.es/proyectos/Obramat/Control-rupturas/recursos/Tutorial/tuto-7.gif"
                    alt="Formulario inicial: nombre y subida del archivo"
                  />
                </div>
                <p>
                  Cuando todas las tarjetas incluidas tengan los campos
                  obligatorios completos, se activar
                  <strong>Generar informe</strong>.
                </p>
                <p>
                  Se abrir un modal con la <strong>previsualizacin</strong> y
                  un <strong>nombre recomendado</strong> (editable).
                </p>
              </section>

              <section class="ayuda-step" data-step>
                <h4>8. Descargar o compartir</h4>
                <div class="ayuda-media">
                  <img
                    src="https://ronaldherrera.es/proyectos/Obramat/Control-rupturas/recursos/Tutorial/tuto-8.gif"
                    alt="Formulario inicial: nombre y subida del archivo"
                  />
                </div>
                <p>Desde la previsualizacin final puedes:</p>
                <ul>
                  <li><strong>Descargar</strong> el informe</li>
                  <li><strong>Compartir</strong> el informe</li>
                </ul>
                <p>
                  Antes de hacerlo, puedes inspeccionar el documento completo.
                </p>
              </section>
            </div>

            <div class="ayuda-nav">
              <button type="button" class="ayuda-btn" data-prev>
                Anterior
              </button>

              <div
                class="ayuda-dots"
                data-dots
                aria-label="Pasos del tutorial"
              ></div>

              <button type="button" class="ayuda-btn" data-next>
                Siguiente
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ===== Modal Crditos ===== -->
    <div class="modal-mini" id="modal-creditos" aria-hidden="true">
      <div class="modal-capa" data-close="modal-creditos"></div>
      <div
        class="modal-caja"
        role="dialog"
        aria-modal="true"
        aria-label="Crditos"
      >
        <div class="modal-header">
          <h3>Crditos</h3>
          <button
            class="modal-cerrar"
            type="button"
            data-close="modal-creditos"
          >
            
          </button>
        </div>
        <div class="modal-body">
          <div class="creditos-grid">
            <!-- Columna izquierda -->
            <div class="creditos-card">
              <div class="creditos-top">
                <img
                  class="creditos-foto"
                  src="https://ronaldherrera.es/proyectos/Obramat/Control-rupturas/recursos/Perfil.png"
                  alt="Foto de Ronald Herrera"
                />

                <div class="creditos-identidad">
                  <div class="creditos-nombre">Ronald Herrera</div>
                  <div class="creditos-rol">
                    Obramat 
                    <span class="creditos-depto"
                      >[Vendedor / Electricidad]</span
                    >
                  </div>
                  <div class="creditos-zona">Santander (Cantabria)</div>
                </div>
              </div>

              <hr class="creditos-sep" />

              <div class="creditos-contacto">
                <div class="contacto-item">
                  <span class="contacto-label">Email</span>
                  <a
                    class="contacto-value"
                    href="mailto:ronald-simon.calzadillah@obramat.es"
                    >ronald-simon.calzadillah@obramat.es</a
                  >
                </div>

                <div class="contacto-item">
                  <span class="contacto-label">Telfono / Extensin</span>
                  <div>
                    <a class="contacto-value" href="tel:+34638436482"
                      >+34 638 436 482</a
                    >
                    /
                    <a class="contacto-value" href="tel:61534">61534</a>
                  </div>
                </div>
              </div>
            </div>

            <!-- Columna derecha -->
            <div class="creditos-card creditos-texto">
              <h4 class="creditos-h">Por qu hice esta app</h4>
              <p class="creditos-p">
                La desarroll para hacer mi trabajo ms gil y ordenado en el
                da a da. El control de rupturas suele implicar muchos pasos,
                revisiones y decisiones rpidas, y la idea era reducir friccin:
                menos tiempo buscando informacin y ms claridad para decidir
                qu hacer en cada caso.
              </p>

              <h4 class="creditos-h">Objetivo</h4>
              <p class="creditos-p">
                A medio plazo, mi objetivo es poder dedicarme dentro de la
                empresa al desarrollo de este tipo de herramientas internas:
                aplicaciones prcticas, pensadas desde el uso real, que ayuden a
                mejorar la experiencia de trabajo y optimicen procesos del da a
                da. <br /><br />Esta app es un primer paso en esa direccin:
                aprender, probar, iterar y demostrar que pequeas mejoras bien
                enfocadas pueden tener un impacto real.
              </p>

              <h4 class="creditos-h">Filosofa</h4>
              <p class="creditos-p creditos-muted">
                Herramientas sencillas, claras y tiles. Si algo no se entiende
                a la primera, no est bien diseado. La idea es seguir
                mejorndola poco a poco en base al uso real y al feedback.
                <br /><br />
                Si ves algo que se pueda mejorar (detalle, filtro, botn,
                flujo), dmelo.
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ===== Modal Compartir (QR) ===== -->
    <div class="modal-mini" id="modal-qr" aria-hidden="true">
      <div class="modal-capa" data-close="modal-qr"></div>
      <div
        class="modal-caja"
        role="dialog"
        aria-modal="true"
        aria-label="Compartir"
      >
        <div class="modal-header">
          <h3>Compartir enlace</h3>
          <button class="modal-cerrar" type="button" data-close="modal-qr">
            
          </button>
        </div>
        <div class="modal-body">
          <div class="qr-wrap">
            <img
              src="https://ronaldherrera.es/proyectos/Obramat/Control-rupturas/recursos/qr.svg"
              alt="Cdigo QR para compartir la app"
              style="
                width: 220px;
                height: 220px;
                object-fit: contain;
                border-radius: 12px;
                border: 2px solid #ff5800;
                background: #fff;
                padding: 8px;
              "
            />

            <p
              style="
                font-size: 12px;
                color: #555;
                margin: 0;
                text-align: center;
              "
            >
              Escanea el cdigo para abrir la aplicacin
            </p>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
